<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Messaging Layer Security (MLS) Architecture</title>
<meta content="Benjamin Beurdouche" name="author">
<meta content="Eric Rescorla" name="author">
<meta content="Emad Omara" name="author">
<meta content="Srinivas Inguva" name="author">
<meta content="Alan Duric" name="author">
<meta content="
       The Messaging Layer Security (MLS) protocol (I-D.ietf-mls-protocol)
provides a Group Key Agreement protocol for messaging applications.
MLS is meant to protect against eavesdropping, tampering, message
forgery, and provide Forward Secrecy (FS) and Post-Compromise Security
(PCS). 
       This document describes the architecture for using MLS in a general
secure group messaging infrastructure and defines the security goals
for MLS.  It provides guidance on building a group messaging system
and discusses security and privacy tradeoffs offered by multiple
security mechanisms that are part of the MLS protocol (e.g., frequency
of public encryption key rotation). The document also provides
guidance for parts of the infrastructure that are not standardized by
MLS and are instead left to the application. 
       While the recommendations of this document are not mandatory to follow in order
to interoperate at the protocol level, they affect the overall security
guarantees that are achieved by a messaging application. This is especially true
in the case of active adversaries that are able to compromise clients, the
delivery service, or the authentication service. 
    " name="description">
<meta content="xml2rfc 3.20.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-mls-architecture-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.20.1
    Python 3.11.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.2.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-mls-architecture.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">MLS Architecture</td>
<td class="right">March 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Beurdouche, et al.</td>
<td class="center">Expires 23 September 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-mls-architecture-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-03-22" class="published">22 March 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-09-23">23 September 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Beurdouche</div>
<div class="org">Inria &amp; Mozilla</div>
</div>
<div class="author">
      <div class="author-name">E. Rescorla</div>
<div class="org">Mozilla</div>
</div>
<div class="author">
      <div class="author-name">E. Omara</div>
</div>
<div class="author">
      <div class="author-name">S. Inguva</div>
</div>
<div class="author">
      <div class="author-name">A. Duric</div>
<div class="org">Wire</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Messaging Layer Security (MLS) Architecture</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Messaging Layer Security (MLS) protocol (I-D.ietf-mls-protocol)
provides a Group Key Agreement protocol for messaging applications.
MLS is meant to protect against eavesdropping, tampering, message
forgery, and provide Forward Secrecy (FS) and Post-Compromise Security
(PCS).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document describes the architecture for using MLS in a general
secure group messaging infrastructure and defines the security goals
for MLS.  It provides guidance on building a group messaging system
and discusses security and privacy tradeoffs offered by multiple
security mechanisms that are part of the MLS protocol (e.g., frequency
of public encryption key rotation). The document also provides
guidance for parts of the infrastructure that are not standardized by
MLS and are instead left to the application.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">While the recommendations of this document are not mandatory to follow in order
to interoperate at the protocol level, they affect the overall security
guarantees that are achieved by a messaging application. This is especially true
in the case of active adversaries that are able to compromise clients, the
delivery service, or the authentication service.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  MLS Working Group mailing list (mls@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/mls/">https://mailarchive.ietf.org/arch/browse/mls/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/mlswg/mls-architecture">https://github.com/mlswg/mls-architecture</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 September 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-general-setting" class="internal xref">General Setting</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-abstract-services" class="internal xref">Abstract Services</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview-of-operation" class="internal xref">Overview of Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-step-1-account-creation" class="internal xref">Step 1: Account Creation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-step-2-initial-keying-mater" class="internal xref">Step 2: Initial Keying Material</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-step-3-adding-bob-to-the-gr" class="internal xref">Step 3: Adding Bob to the Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-step-4-adding-charlie-to-th" class="internal xref">Step 4: Adding Charlie to the Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-other-group-operations" class="internal xref">Other Group Operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-proposals-and-commits" class="internal xref">Proposals and Commits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-users-clients-and-groups" class="internal xref">Users, Clients, and Groups</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-authentication-service" class="internal xref">Authentication Service</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-delivery-service" class="internal xref">Delivery Service</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-key-storage-and-retrieval" class="internal xref">Key Storage and Retrieval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-delivery-of-messages" class="internal xref">Delivery of Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-strongly-consistent" class="internal xref">Strongly Consistent</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-eventually-consistent" class="internal xref">Eventually Consistent</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-functional-requirements" class="internal xref">Functional Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-membership-changes" class="internal xref">Membership Changes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-parallel-groups" class="internal xref">Parallel Groups</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-asynchronous-usage" class="internal xref">Asynchronous Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-access-control" class="internal xref">Access Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-handling-authentication-fai" class="internal xref">Handling Authentication Failures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-recovery-after-state-loss" class="internal xref">Recovery After State Loss</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-support-for-multiple-device" class="internal xref">Support for Multiple Devices</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-extensibility" class="internal xref">Extensibility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-application-data-framing-an" class="internal xref">Application Data Framing and Type Advertisements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-federation" class="internal xref">Federation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.11">
                <p id="section-toc.1-1.6.2.11.1"><a href="#section-6.11" class="auto internal xref">6.11</a>. <a href="#name-compatibility-with-future-v" class="internal xref">Compatibility with Future Versions of MLS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-operational-requirements" class="internal xref">Operational Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-and-privacy-consid" class="internal xref">Security and Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-assumptions-on-transport-se" class="internal xref">Assumptions on Transport Security Links</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-integrity-and-authenticatio" class="internal xref">Integrity and Authentication of Custom Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-metadata-protection-for-une" class="internal xref">Metadata Protection for Unencrypted Group Operations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.3">
                    <p id="section-toc.1-1.8.2.1.2.3.1"><a href="#section-8.1.3" class="auto internal xref">8.1.3</a>.  <a href="#name-dos-protection" class="internal xref">DoS protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.4">
                    <p id="section-toc.1-1.8.2.1.2.4.1"><a href="#section-8.1.4" class="auto internal xref">8.1.4</a>.  <a href="#name-message-suppression-and-err" class="internal xref">Message Suppression and Error Correction</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-intended-security-guarantee" class="internal xref">Intended Security Guarantees</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-message-secrecy-and-authent" class="internal xref">Message Secrecy and Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-forward-and-post-compromise" class="internal xref">Forward and Post-Compromise Security</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a href="#section-8.2.3" class="auto internal xref">8.2.3</a>.  <a href="#name-non-repudiation-vs-deniabil" class="internal xref">Non-Repudiation vs Deniability</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a href="#section-8.2.4" class="auto internal xref">8.2.4</a>.  <a href="#name-associating-a-users-clients" class="internal xref">Associating a User's Clients</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-endpoint-compromise" class="internal xref">Endpoint Compromise</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-compromise-of-symmetric-key" class="internal xref">Compromise of Symmetric Keying Material</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-compromise-by-an-active-adv" class="internal xref">Compromise by an active adversary with the ability to sign messages</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.3">
                    <p id="section-toc.1-1.8.2.3.2.3.1"><a href="#section-8.3.3" class="auto internal xref">8.3.3</a>.  <a href="#name-compromise-of-the-authentic" class="internal xref">Compromise of the authentication with access to a signature key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.4">
                    <p id="section-toc.1-1.8.2.3.2.4.1"><a href="#section-8.3.4" class="auto internal xref">8.3.4</a>.  <a href="#name-security-consideration-in-t" class="internal xref">Security consideration in the context of a full state compromise</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-service-node-compromise" class="internal xref">Service Node Compromise</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-general-considerations" class="internal xref">General considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-delivery-service-compromise" class="internal xref">Delivery Service Compromise</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="auto internal xref">8.4.3</a>.  <a href="#name-authentication-service-comp" class="internal xref">Authentication Service Compromise</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-considerations-for-attacks-" class="internal xref">Considerations for attacks outside of the threat model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-cryptographic-analysis-of-t" class="internal xref">Cryptographic Analysis of the MLS Protocol</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The source for this draft is maintained in GitHub.  Suggested changes should
be submitted as pull requests at https://github.com/mlswg/mls-architecture.
Instructions are on that page as well.  Editorial changes can be
managed in GitHub, but any substantive change should be discussed on
the MLS mailing list.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">End-to-end security is a used in the vast majority of instant messaging systems,
and also deployed in systems for other purposes such as calling and conferencing.
In this context, "end-to-end" captures
the notion that users of the system enjoy some level of security -- with the
precise level depending on the system design -- even in the face of malicious
actions by the operator of the messaging system.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Messaging Layer Security (MLS) specifies an architecture (this document) and a
protocol <span>[<a href="#I-D.ietf-mls-protocol" class="cite xref">I-D.ietf-mls-protocol</a>]</span> for providing end-to-end security in this
setting. MLS is not intended as a full instant messaging protocol but rather is
intended to be embedded in concrete protocols, such as XMPP <span>[<a href="#RFC6120" class="cite xref">RFC6120</a>]</span>.
Implementations of the MLS protocol will interoperate at the cryptographic
level, though they may have incompatibilities in terms of how protected messages
are delivered, contents of protected messages, and identity/authentication
infrastructures.
The MLS protocol has been designed to provide the same security guarantees to
all users, for all group sizes, including groups of only two clients.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="general-setting">
<section id="section-2">
      <h2 id="name-general-setting">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-general-setting" class="section-name selfRef">General Setting</a>
      </h2>
<div id="protocol-overview">
<section id="section-2.1">
        <h3 id="name-protocol-overview">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
        </h3>
<p id="section-2.1-1">MLS provides a way for <em>clients</em> to form <em>groups</em> within which they can
communicate securely.  For example, a set of users might use clients on their
phones or laptops to join a group and communicate with each other. A group may
be as small as two clients (e.g., for simple person to person messaging) or as
large as hundreds of thousands.  A client that is part of a group is a <em>member</em>
of that group. As groups change membership and group or member properties, they
advance from one <em>epoch</em> to another and the cryptographic state of the group
evolves.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The group is represented as a tree, which represents the members as the leaves
of a tree. It is used to efficiently encrypt to subsets of the members. Each
member has a state called a <em>LeafNode</em> object holding the client's identity,
credentials, and capabilities.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Various messages are used in the evolution from epoch to epoch.
A <em>Proposal</em> message proposes
a change to be made in the next epoch, such as adding or removing a member.
A <em>Commit</em> message initiates a new epoch by instructing members of the group to
implement a collection of proposals. Proposals and Commits are collectively
called <em>Handshake messages</em>.
A <em>KeyPackage</em> provides keys that can be used to add the client to a group,
including its LeafNode, and <em>Signature Key</em>.
A <em>Welcome</em> message provides a new member to the group with the information to
initialize their state for the epoch in which they were added.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Of course most (but not all) applications use MLS to send encrypted group messages.
An <em>application message</em> is an MLS message with an arbitrary application payload.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Finally, a <em>PublicMessage</em> contains an integrity-protected MLS Handshake message,
while a <em>PrivateMessage</em> contains a confidential, integrity-protected Handshake
or application message.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">For a more detailed explanation of these terms, please consult the MLS protocol
specification <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="abstract-services">
<section id="section-2.2">
        <h3 id="name-abstract-services">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-abstract-services" class="section-name selfRef">Abstract Services</a>
        </h3>
<p id="section-2.2-1">MLS is designed to operate within the context of a messaging service, which
may be a single service provider, a federated system, or some kind of
peer-to-peer system. The service needs to provide two services that
facilitate client communication using MLS:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.1">
            <p id="section-2.2-2.1.1">An Authentication Service (AS) which is responsible for
attesting to bindings between application-meaningful identifiers and the
public key material used for authentication in the MLS protocol. The
AS must also be able to generate credentials that encode these
bindings and validate credentials provided by MLS clients.<a href="#section-2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.2">
            <p id="section-2.2-2.2.1">A Delivery Service (DS)  which can receive and distribute
messages between group members. In the case of group messaging, the delivery
service may also be responsible for acting as a "broadcaster" where the sender
sends a single message which is then forwarded to each recipient in the group
by the DS. The DS is also responsible for storing and delivering initial
public key material required by MLS clients in order to proceed with the group
secret key establishment that is part of the MLS protocol.<a href="#section-2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-3">For presentation purposes, this document treats the AS and DS as conventional
network services, however MLS does not require a specific implementation
for the AS or DS. These services may reside on the same server or different
servers, they may be distributed between server and client components, and they
may even involve some action by users.  For example:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-4.1">
            <p id="section-2.2-4.1.1">Several secure messaging services today provide a centralized DS, and rely on
manual comparison of clients' public keys as the AS.<a href="#section-2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-4.2">
            <p id="section-2.2-4.2.1">MLS clients connected to a peer-to-peer network could instantiate a
decentralized DS by transmitting MLS messages over that network.<a href="#section-2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-4.3">
            <p id="section-2.2-4.3.1">In an MLS group using a Public Key Infrastructure (PKI) for authentication,
the AS would comprise the certificate issuance and validation processes,
both of which involve logic inside MLS clients as well as various
existing PKI roles (ex: Certification Authorities).<a href="#section-2.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-5">It is important to note that the Authentication Service can be
completely abstract in the case of a Service Provider which allows MLS
clients to generate, distribute, and validate credentials themselves.
As with the AS, the Delivery Service can be completely abstract if
users are able to distribute credentials and messages without relying
on a central Delivery Service (as in a peer-to-peer system).  Note,
though, that in such scenarios, clients will need to implement logic
that assures the delivery properties required of the DS (see
<a href="#delivery-guarantees" class="auto internal xref">Section 5.2</a>).<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<span id="name-a-simplified-messaging-syst"></span><div id="fig-mls-overview">
<figure id="figure-1">
          <div id="section-2.2-6.1">
            <div class="alignLeft art-svg artwork" id="section-2.2-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="456" viewBox="0 0 456 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 80,144 L 80,176" fill="none" stroke="black"></path>
                <path d="M 144,32 L 144,80" fill="none" stroke="black"></path>
                <path d="M 168,144 L 168,176" fill="none" stroke="black"></path>
                <path d="M 184,32 L 184,80" fill="none" stroke="black"></path>
                <path d="M 208,144 L 208,176" fill="none" stroke="black"></path>
                <path d="M 248,80 L 248,144" fill="none" stroke="black"></path>
                <path d="M 296,144 L 296,176" fill="none" stroke="black"></path>
                <path d="M 304,32 L 304,80" fill="none" stroke="black"></path>
                <path d="M 336,144 L 336,176" fill="none" stroke="black"></path>
                <path d="M 424,144 L 424,176" fill="none" stroke="black"></path>
                <path d="M 8,32 L 144,32" fill="none" stroke="black"></path>
                <path d="M 184,32 L 304,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 144,80" fill="none" stroke="black"></path>
                <path d="M 184,80 L 304,80" fill="none" stroke="black"></path>
                <path d="M 80,144 L 168,144" fill="none" stroke="black"></path>
                <path d="M 208,144 L 296,144" fill="none" stroke="black"></path>
                <path d="M 336,144 L 424,144" fill="none" stroke="black"></path>
                <path d="M 80,176 L 168,176" fill="none" stroke="black"></path>
                <path d="M 208,176 L 296,176" fill="none" stroke="black"></path>
                <path d="M 336,176 L 424,176" fill="none" stroke="black"></path>
                <path d="M 304,80 L 336,144" fill="none" stroke="black"></path>
                <path d="M 152,144 L 184,80" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="76" y="52">Authentication</text>
                  <text x="244" y="52">Delivery</text>
                  <text x="56" y="68">Service</text>
                  <text x="108" y="68">(AS)</text>
                  <text x="224" y="68">Service</text>
                  <text x="276" y="68">(DS)</text>
                  <text x="432" y="100">Group</text>
                  <text x="212" y="116">........</text>
                  <text x="284" y="116">........</text>
                  <text x="388" y="116">................</text>
                  <text x="184" y="132">.</text>
                  <text x="448" y="132">.</text>
                  <text x="184" y="148">.</text>
                  <text x="448" y="148">.</text>
                  <text x="116" y="164">Client</text>
                  <text x="152" y="164">1</text>
                  <text x="184" y="164">.</text>
                  <text x="244" y="164">Client</text>
                  <text x="280" y="164">2</text>
                  <text x="372" y="164">Client</text>
                  <text x="408" y="164">3</text>
                  <text x="448" y="164">.</text>
                  <text x="184" y="180">.</text>
                  <text x="448" y="180">.</text>
                  <text x="184" y="196">.</text>
                  <text x="236" y="196">Member</text>
                  <text x="272" y="196">1</text>
                  <text x="364" y="196">Member</text>
                  <text x="400" y="196">2</text>
                  <text x="448" y="196">.</text>
                  <text x="184" y="212">.</text>
                  <text x="448" y="212">.</text>
                  <text x="316" y="228">..................................</text>
                </g>
              </svg><a href="#section-2.2-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-a-simplified-messaging-syst" class="selfRef">A Simplified Messaging System</a>
          </figcaption></figure>
</div>
<p id="section-2.2-7"><a href="#fig-mls-overview" class="auto internal xref">Figure 1</a> shows the relationship of these concepts,
with three clients and one group, and clients 2 and 3 being
part of the group and client 1 not being part of any group.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview-of-operation">
<section id="section-3">
      <h2 id="name-overview-of-operation">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview-of-operation" class="section-name selfRef">Overview of Operation</a>
      </h2>
<p id="section-3-1"><a href="#fig-group-formation-example" class="auto internal xref">Figure 2</a> shows the formation of an example
group consisting of Alice, Bob, and Charlie, with Alice
driving the creation of the group.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-group-formation-example"></span><div id="fig-group-formation-example">
<figure id="figure-2">
        <div id="section-3-2.1">
          <div class="alignLeft art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="464" width="592" viewBox="0 0 592 464" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 528,64 L 528,144" fill="none" stroke="black"></path>
              <path d="M 528,176 L 528,208" fill="none" stroke="black"></path>
              <path d="M 528,240 L 528,320" fill="none" stroke="black"></path>
              <path d="M 528,352 L 528,448" fill="none" stroke="black"></path>
              <path d="M 128,64 L 392,64" fill="none" stroke="black"></path>
              <path d="M 8,80 L 304,80" fill="none" stroke="black"></path>
              <path d="M 208,96 L 392,96" fill="none" stroke="black"></path>
              <path d="M 88,112 L 304,112" fill="none" stroke="black"></path>
              <path d="M 288,128 L 392,128" fill="none" stroke="black"></path>
              <path d="M 168,144 L 304,144" fill="none" stroke="black"></path>
              <path d="M 200,176 L 480,176" fill="none" stroke="black"></path>
              <path d="M 280,192 L 480,192" fill="none" stroke="black"></path>
              <path d="M 360,208 L 480,208" fill="none" stroke="black"></path>
              <path d="M 264,240 L 392,240" fill="none" stroke="black"></path>
              <path d="M 8,256 L 168,256" fill="none" stroke="black"></path>
              <path d="M 144,272 L 480,272" fill="none" stroke="black"></path>
              <path d="M 104,288 L 480,288" fill="none" stroke="black"></path>
              <path d="M 88,304 L 344,304" fill="none" stroke="black"></path>
              <path d="M 88,320 L 368,320" fill="none" stroke="black"></path>
              <path d="M 296,352 L 392,352" fill="none" stroke="black"></path>
              <path d="M 8,368 L 136,368" fill="none" stroke="black"></path>
              <path d="M 176,384 L 480,384" fill="none" stroke="black"></path>
              <path d="M 152,400 L 480,400" fill="none" stroke="black"></path>
              <path d="M 88,416 L 312,416" fill="none" stroke="black"></path>
              <path d="M 176,432 L 312,432" fill="none" stroke="black"></path>
              <path d="M 176,448 L 336,448" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="488,400 476,394.4 476,405.6" fill="black" transform="rotate(0,480,400)"></polygon>
              <polygon class="arrowhead" points="488,384 476,378.4 476,389.6" fill="black" transform="rotate(0,480,384)"></polygon>
              <polygon class="arrowhead" points="488,288 476,282.4 476,293.6" fill="black" transform="rotate(0,480,288)"></polygon>
              <polygon class="arrowhead" points="488,272 476,266.4 476,277.6" fill="black" transform="rotate(0,480,272)"></polygon>
              <polygon class="arrowhead" points="488,208 476,202.4 476,213.6" fill="black" transform="rotate(0,480,208)"></polygon>
              <polygon class="arrowhead" points="488,192 476,186.4 476,197.6" fill="black" transform="rotate(0,480,192)"></polygon>
              <polygon class="arrowhead" points="488,176 476,170.4 476,181.6" fill="black" transform="rotate(0,480,176)"></polygon>
              <polygon class="arrowhead" points="400,352 388,346.4 388,357.6" fill="black" transform="rotate(0,392,352)"></polygon>
              <polygon class="arrowhead" points="400,240 388,234.4 388,245.6" fill="black" transform="rotate(0,392,240)"></polygon>
              <polygon class="arrowhead" points="400,128 388,122.4 388,133.6" fill="black" transform="rotate(0,392,128)"></polygon>
              <polygon class="arrowhead" points="400,96 388,90.4 388,101.6" fill="black" transform="rotate(0,392,96)"></polygon>
              <polygon class="arrowhead" points="400,64 388,58.4 388,69.6" fill="black" transform="rotate(0,392,64)"></polygon>
              <polygon class="arrowhead" points="184,448 172,442.4 172,453.6" fill="black" transform="rotate(180,176,448)"></polygon>
              <polygon class="arrowhead" points="184,432 172,426.4 172,437.6" fill="black" transform="rotate(180,176,432)"></polygon>
              <polygon class="arrowhead" points="176,144 164,138.4 164,149.6" fill="black" transform="rotate(180,168,144)"></polygon>
              <polygon class="arrowhead" points="96,416 84,410.4 84,421.6" fill="black" transform="rotate(180,88,416)"></polygon>
              <polygon class="arrowhead" points="96,320 84,314.4 84,325.6" fill="black" transform="rotate(180,88,320)"></polygon>
              <polygon class="arrowhead" points="96,304 84,298.4 84,309.6" fill="black" transform="rotate(180,88,304)"></polygon>
              <polygon class="arrowhead" points="96,112 84,106.4 84,117.6" fill="black" transform="rotate(180,88,112)"></polygon>
              <polygon class="arrowhead" points="16,368 4,362.4 4,373.6" fill="black" transform="rotate(180,8,368)"></polygon>
              <polygon class="arrowhead" points="16,256 4,250.4 4,261.6" fill="black" transform="rotate(180,8,256)"></polygon>
              <polygon class="arrowhead" points="16,80 4,74.4 4,85.6" fill="black" transform="rotate(180,8,80)"></polygon>
              <g class="text">
                <text x="24" y="36">Alice</text>
                <text x="96" y="36">Bob</text>
                <text x="192" y="36">Charlie</text>
                <text x="396" y="36">AS</text>
                <text x="476" y="36">DS</text>
                <text x="28" y="68">Create</text>
                <text x="88" y="68">account</text>
                <text x="356" y="84">Credential</text>
                <text x="108" y="100">Create</text>
                <text x="168" y="100">account</text>
                <text x="556" y="100">Step</text>
                <text x="584" y="100">1</text>
                <text x="356" y="116">Credential</text>
                <text x="188" y="132">Create</text>
                <text x="248" y="132">account</text>
                <text x="356" y="148">Credential</text>
                <text x="32" y="180">Initial</text>
                <text x="92" y="180">Keying</text>
                <text x="156" y="180">Material</text>
                <text x="112" y="196">Initial</text>
                <text x="172" y="196">Keying</text>
                <text x="236" y="196">Material</text>
                <text x="556" y="196">Step</text>
                <text x="584" y="196">2</text>
                <text x="192" y="212">Initial</text>
                <text x="252" y="212">Keying</text>
                <text x="316" y="212">Material</text>
                <text x="16" y="244">Get</text>
                <text x="48" y="244">Bob</text>
                <text x="96" y="244">Initial</text>
                <text x="156" y="244">Keying</text>
                <text x="220" y="244">Material</text>
                <text x="192" y="260">Bob</text>
                <text x="240" y="260">Initial</text>
                <text x="300" y="260">Keying</text>
                <text x="364" y="260">Material</text>
                <text x="16" y="276">Add</text>
                <text x="48" y="276">Bob</text>
                <text x="76" y="276">to</text>
                <text x="112" y="276">Group</text>
                <text x="556" y="276">Step</text>
                <text x="584" y="276">3</text>
                <text x="32" y="292">Welcome</text>
                <text x="84" y="292">(Bob</text>
                <text x="368" y="308">Add</text>
                <text x="400" y="308">Bob</text>
                <text x="428" y="308">to</text>
                <text x="464" y="308">Group</text>
                <text x="408" y="324">Welcome</text>
                <text x="464" y="324">(Bob)</text>
                <text x="16" y="356">Get</text>
                <text x="64" y="356">Charlie</text>
                <text x="128" y="356">Initial</text>
                <text x="188" y="356">Keying</text>
                <text x="252" y="356">Material</text>
                <text x="176" y="372">Charlie</text>
                <text x="240" y="372">Initial</text>
                <text x="300" y="372">Keying</text>
                <text x="364" y="372">Material</text>
                <text x="16" y="388">Add</text>
                <text x="64" y="388">Charlie</text>
                <text x="108" y="388">to</text>
                <text x="144" y="388">Group</text>
                <text x="32" y="404">Welcome</text>
                <text x="104" y="404">(Charlie)</text>
                <text x="556" y="404">Step</text>
                <text x="584" y="404">4</text>
                <text x="336" y="420">Add</text>
                <text x="384" y="420">Charlie</text>
                <text x="428" y="420">to</text>
                <text x="464" y="420">Group</text>
                <text x="336" y="436">Add</text>
                <text x="384" y="436">Charlie</text>
                <text x="428" y="436">to</text>
                <text x="464" y="436">Group</text>
                <text x="376" y="452">Welcome</text>
                <text x="448" y="452">(Charlie)</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-group-formation-example" class="selfRef">Group Formation Example</a>
        </figcaption></figure>
</div>
<p id="section-3-3">This process proceeds as follows.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="step-1-account-creation">
<section id="section-3.1">
        <h3 id="name-step-1-account-creation">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-step-1-account-creation" class="section-name selfRef">Step 1: Account Creation</a>
        </h3>
<p id="section-3.1-1">Alice, Bob, and Charlie create accounts with a service provider and obtain
credentials from the AS. This is a one-time setup phase.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-2-initial-keying-material">
<section id="section-3.2">
        <h3 id="name-step-2-initial-keying-mater">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-step-2-initial-keying-mater" class="section-name selfRef">Step 2: Initial Keying Material</a>
        </h3>
<p id="section-3.2-1">Alice, Bob, and Charlie authenticate to the DS and store some initial
keying material which can be used to send encrypted messages to them
for the first time. This keying material is authenticated with their
long-term credentials. Although in principle this keying material
can be reused for multiple senders, in order to provide forward secrecy
it is better for this material to be regularly refreshed so that each
sender can use a new key.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-3-adding-bob-to-the-group">
<section id="section-3.3">
        <h3 id="name-step-3-adding-bob-to-the-gr">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-step-3-adding-bob-to-the-gr" class="section-name selfRef">Step 3: Adding Bob to the Group</a>
        </h3>
<p id="section-3.3-1">When Alice wants to create a group including Bob, she first uses the DS to look
up his initial keying material. She then generates two messages:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">
            <p id="section-3.3-2.1.1">A message to the entire group (which at this point is just her and Bob)
that adds Bob to the group.<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.2">
            <p id="section-3.3-2.2.1">A <em>Welcome</em> message just to Bob encrypted with his initial keying material that
includes the secret keying information necessary to join the group.<a href="#section-3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-3">She sends both of these messages to the Delivery Services, which is responsible
for sending them to the appropriate people. Note that the security of MLS
does not depend on the DS forwarding the Welcome message only to Bob, as it
is encrypted for him; it is simply not necessary for other group members
to receive it.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-4-adding-charlie-to-the-group">
<section id="section-3.4">
        <h3 id="name-step-4-adding-charlie-to-th">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-step-4-adding-charlie-to-th" class="section-name selfRef">Step 4: Adding Charlie to the Group</a>
        </h3>
<p id="section-3.4-1">If Alice then wants to add Charlie to the group, she follows a similar procedure
as with Bob: she first uses the DS to look
up his initial keying material and then generates two messages:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">A message to the entire group (consisting of her, Bob, and Charlie) adding
Charlie to the group.<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">A <em>Welcome</em> message just to Charlie encrypted with his initial keying material that
includes the secret keying information necessary to join the group.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-3">At the completion of this process, we have a group with Alice, Bob, and Charlie,
which means that they share a single encryption key which can be used to
send messages or to key other protocols.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-group-operations">
<section id="section-3.5">
        <h3 id="name-other-group-operations">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-other-group-operations" class="section-name selfRef">Other Group Operations</a>
        </h3>
<p id="section-3.5-1">Once the group has been created, clients can perform other actions,
such as:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-2.1">
            <p id="section-3.5-2.1.1">sending a message to everyone in the group<a href="#section-3.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.2">
            <p id="section-3.5-2.2.1">receiving a message from someone in the group<a href="#section-3.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.3">
            <p id="section-3.5-2.3.1">adding one or more clients to an existing group<a href="#section-3.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.4">
            <p id="section-3.5-2.4.1">remove one or more members from an existing group<a href="#section-3.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.5">
            <p id="section-3.5-2.5.1">updating their own key material<a href="#section-3.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.5-2.6">
            <p id="section-3.5-2.6.1">leave a group (by asking to be removed)<a href="#section-3.5-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.5-3">Importantly, MLS does not itself enforce any access control on group
operations. For instance, any member of the group can send a message
to add a new member or to evict an existing member.
This is in contrast to some designs in which there is a single group
controller who can modify the group. MLS-using applications are
responsible for setting their own access control policies. For instance,
if only the group administrator is allowed to change group members,
then it is the responsibility of the application to inform members
of this policy and who the administrator is.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proposals-and-commits">
<section id="section-3.6">
        <h3 id="name-proposals-and-commits">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-proposals-and-commits" class="section-name selfRef">Proposals and Commits</a>
        </h3>
<p id="section-3.6-1">The general pattern for any change in the group state (e.g., to add or remove
a user) is that it consists of two messages:<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.6-2">
          <dt id="section-3.6-2.1">Proposal</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-2.2">
            <p id="section-3.6-2.2.1">This message describes the change to be made (e.g., add Bob to the group)
but does not effect a change.<a href="#section-3.6-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-2.3">Commit</dt>
          <dd style="margin-left: 1.5em" id="section-3.6-2.4">
            <p id="section-3.6-2.4.1">This message changes the group state to include the changes described in
a set of proposals.<a href="#section-3.6-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.6-3">The simplest pattern is for a client to just send a Commit which contains one or
more Proposals, for instance Alice could send a Commit with the Proposal
Add(Bob) embedded to add Bob to the group. However, there are situations in
which one client might send a proposal and another might send the commit. For
instance, Bob might wish to remove himself from the group and send a Remove
Proposal to do so (see <span><a href="https://rfc-editor.org/rfc/rfc9420#section-12.1.3" class="relref">Section 12.1.3</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>). Because Bob cannot send
the Commit, an existing member must do so.  Commits can apply to multiple valid
Proposals, in which case all the listed changes are applied.<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<p id="section-3.6-4">It is also possible for a Commit to apply to an empty set of Proposals
in which case it just updates the cryptographic state of the group
without changing its membership.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="group-members">
<section id="section-3.7">
        <h3 id="name-users-clients-and-groups">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-users-clients-and-groups" class="section-name selfRef">Users, Clients, and Groups</a>
        </h3>
<p id="section-3.7-1">While it's natural to think of a messaging system as consisting of groups of
users, possibly using different devices, in MLS the basic unit of operation is
not the user but rather the "client".  Formally, a client is a set of
cryptographic objects composed of public values such as a name (an identity), a
public encryption key, and a public signature key. As usual, a user demonstrates
ownership of the client by demonstrating knowledge of the associated secret
values.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">In some messaging systems, clients belonging to the same user must all share the
same signature key pair, but MLS does not assume this; instead a user may have
multiple clients with the same identity and different keys. In this case, each
client will have its own cryptographic state, and it is up to the application to
determine how to present this situation to users. For instance, it may render
messages to and from a given user identically regardless of which client they
are associated with, or may choose to distinguish them.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">When a client is part of a Group, it is called a Member.  A group in MLS is
defined as the set of clients that have knowledge of the shared group secret
established in the group key establishment phase.  Note that until a client has
been added to the group and contributed to the group secret in a manner
verifiable by other members of the group, other members cannot assume that the
client is a member of the group; for instance, the newly added member might not
have received the Welcome message or been unable to decrypt it for some reason.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authentication-service">
<section id="section-4">
      <h2 id="name-authentication-service">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-authentication-service" class="section-name selfRef">Authentication Service</a>
      </h2>
<p id="section-4-1">The Authentication Service (AS) has to provide three services:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-2">
<li id="section-4-2.1">
          <p id="section-4-2.1.1">Issue credentials to clients that attest to bindings between identities and
signature key pairs<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.2">
          <p id="section-4-2.2.1">Enable a client to verify that a credential presented by another client is
valid with respect to a reference identifier<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.3">
          <p id="section-4-2.3.1">Enable a group member to verify that a credential represents the same client
as another credential<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-4-3">A member with a valid credential authenticates its MLS messages by signing them
with the private key corresponding to the public key bound by its credential.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The AS is considered an abstract layer by the MLS specification and part of this
service could be, for instance, running on the members' devices, while another
part is a separate entity entirely.  The following examples illustrate the
breadth of this concept:<a href="#section-4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-5.1">
          <p id="section-4-5.1.1">A PKI could be used as an AS <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.  The issuance function would be
provided by the certificate authorities in the PKI, and the verification
function would correspond to certificate verification by clients.<a href="#section-4-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-5.2">
          <p id="section-4-5.2.1">Several current messaging applications rely on users verifying each other's
key fingerprints for authentication.  In this scenario, the issuance function
is simply the generation of a key pair (i.e., a credential is just an
identifier and public key, with no information to assist in verification).
The verification function is the application function that enables users
to verify keys.<a href="#section-4-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-5.3">
          <p id="section-4-5.3.1">In a system based on <span>[<a href="#CONIKS" class="cite xref">CONIKS</a>]</span> end user Key Transparency (KT) <span>[<a href="#KT" class="cite xref">KT</a>]</span>, the
issuance function would correspond to the insertion of a key in a KT log under
a user's identity. The verification function would correspond to verifying a
key's inclusion in the log for a claimed identity, together with the KT log's
mechanisms for a user to monitor and control which keys are associated with
their identity.<a href="#section-4-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-6">By the nature of its roles in MLS authentication, the AS is invested with a
large amount of trust and the compromise of one the AS could
allow an adversary to, among other things, impersonate group members. We discuss
security considerations regarding the compromise of the different AS
functions in detail in <a href="#as-compromise" class="auto internal xref">Section 8.4.3</a>.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">The association between members' identities and signature keys is fairly
flexible in MLS.  As noted above, there is no requirement that all clients
belonging to a given user use the same key pair (in fact, such key reuse is
forbidden to ensure clients have independent cryptographic state).  A member can
also rotate the signature key they use within a group.  These mechanisms allow
clients to use different signature keys in different contexts and at different
points in time, providing unlinkability and post-compromise security benefits.
Some security trade-offs related to this flexibility are discussed in the
security considerations.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">In many applications, there are multiple MLS clients that represent a single
entity, for example a human user with a mobile and desktop version of an
application. Often the same set of clients is represented in exactly the same
list of groups. In applications where this is the intended situation, other
clients can check that a user is consistently represented by the same set of
clients.  This would make it more difficult for a malicious AS to issue fake
credentials for a particular user because clients would expect the credential to
appear in all groups of which the user is a member. If a client credential does
not appear in all groups after some relatively short period of time, clients
have an indication that the credential might have been created without the
user's knowledge. Due to the asynchronous nature of MLS, however, there may be
transient inconsistencies in a user's client set, so correlating users' clients
across groups is more of a detection mechanism than a prevention mechanism.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delivery-service">
<section id="section-5">
      <h2 id="name-delivery-service">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-delivery-service" class="section-name selfRef">Delivery Service</a>
      </h2>
<p id="section-5-1">The Delivery Service (DS) plays two major roles in MLS:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">As a directory service providing the initial keying material for
clients to use. This allows a client to establish a shared key and send
encrypted messages to other clients even if they're offline.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">Routing MLS messages among clients.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">While MLS depends on correct behavior by the Authentication Service in
order to provide endpoint authentication and hence confidentiality of
the group key, these properties do not depend on correct behavior by
the DS; even a malicious DS cannot add itself to groups or recover
the group key. However, depending precisely on how MLS is used, the DS may
be able to determine group membership or prevent changes to the
group from taking place (e.g., by blocking group change messages).<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="key-storage-and-retrieval">
<section id="section-5.1">
        <h3 id="name-key-storage-and-retrieval">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-key-storage-and-retrieval" class="section-name selfRef">Key Storage and Retrieval</a>
        </h3>
<p id="section-5.1-1">Upon joining the system, each client stores its initial cryptographic key
material with the Delivery Service. This key material, called a KeyPackage,
advertises the functional abilities of the client such as supported protocol
versions, supported extensions, and the following cryptographic information:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">A credential from the Authentication Service attesting to the binding between
the identity and the client's signature key.<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">The client's asymmetric encryption public key.<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-3">All the parameters in the KeyPackage are signed with the signature
private key corresponding to the credential.
As noted in <a href="#group-members" class="auto internal xref">Section 3.7</a>, users may own multiple clients, each
with their own keying material. Each KeyPackage is specific to an MLS version
and ciphersuite, but a client may want to offer support for multiple protocol
versions and ciphersuites. As such, there may be multiple KeyPackages stored by
each user for a mix of protocol versions, ciphersuites, and end-user devices.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">When a client wishes to establish a group or add clients to a group, it first
contacts the Delivery Service to request KeyPackages for each other client,
authenticates the KeyPackages using the signature keys, includes the KeyPackages
in Add Proposals, encrypts the information needed to join the group
(the <em>GroupInfo</em> object) with an ephemeral key, then separately encrypts the
ephemeral key with the <code>init_key</code> from each KeyPackage.
When a client requests a KeyPackage in order to add a user to a group, the
Delivery Service should provide the minimum number of KeyPackages necessary to
satisfy the request.  For example, if the request specifies the MLS version, the
DS might provide one KeyPackage per supported ciphersuite, even if it has
multiple such KeyPackages to enable the corresponding client to be added to
multiple groups before needing to upload more fresh KeyPackages.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">In order to avoid replay attacks and provide forward secrecy for messages sent
using the initial keying material, KeyPackages are intended to be used only
once. The Delivery Service is responsible for ensuring that each KeyPackage is
only used to add its client to a single group, with the possible exception of a
"last resort" KeyPackage that is specially designated by the client to be used
multiple times. Clients are responsible for providing new KeyPackages as
necessary in order to minimize the chance that the "last resort" KeyPackage will
be used.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-6.1">
            <p id="section-5.1-6.1.1"><strong>RECOMMENDATION:</strong> Ensure that "last resort" KeyPackages don't get used by
provisionning enough standard KeyPackages.<a href="#section-5.1-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-7.1">
            <p id="section-5.1-7.1.1"><strong>RECOMMENDATION:</strong> Rotate "last resort" KeyPackages as soon as possible
after being used or if they have been stored for a prolonged period of time.
Overall, avoid reusing last resort KeyPackages as much as possible.<a href="#section-5.1-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-8.1">
            <p id="section-5.1-8.1.1"><strong>RECOMMENDATION:</strong> Ensure that the client for which a last resort KeyPackage
has been used is updating leaf keys as early as possible.<a href="#section-5.1-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-9">Overall, it needs to be noted that key packages need to be updated when
signature keys are changed.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delivery-guarantees">
<section id="section-5.2">
        <h3 id="name-delivery-of-messages">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-delivery-of-messages" class="section-name selfRef">Delivery of Messages</a>
        </h3>
<p id="section-5.2-1">The main responsibility of the Delivery Service is to ensure delivery of
messages. Some MLS messages need only be delivered to specific clients (e.g., a
Welcome message initializing a new member's state), while others need to be
delivered to all the members of a group.  The Delivery Service may enable the
latter delivery pattern via unicast channels (sometimes known as "client
fanout"), broadcast channels ("server fanout"), or a mix of both.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">For the most part, MLS does not require the Delivery Service to deliver messages
in any particular order. Applications can set policies that control their
tolerance for out-of-order messages (see <a href="#operational-requirements" class="auto internal xref">Section 7</a>), and
messages that arrive significantly out-of-order can be dropped without otherwise
affecting the protocol. There are two exceptions to this. First, Proposal
messages should all arrive before the Commit that references them.  Second,
because an MLS group has a linear history of epochs, the members of the group
must agree on the order in which changes are applied.  Concretely, the group
must agree on a single MLS Commit message that ends each epoch and begins the
next one.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">In practice, there's a realistic risk of two members generating Commit messages
at the same time, based on the same epoch, and both attempting to send them to
the group at the same time. The extent to which this is a problem, and the
appropriate solution, depends on the design of the Delivery Service. Per the CAP
theorem <span>[<a href="#CAPBR" class="cite xref">CAPBR</a>]</span>, there are two general classes of distributed system that the
Delivery Service might fall into:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-4.1">
            <p id="section-5.2-4.1.1">Consistent and Partition-tolerant, or Strongly Consistent, systems can provide
a globally consistent view of data but has the inconvenient of clients needing
to handle rejected messages;<a href="#section-5.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.2">
            <p id="section-5.2-4.2.1">Available and Partition-tolerant, or Eventually Consistent, systems continue
working despite network issues but may return different views of data to
different users.<a href="#section-5.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-5">Strategies for sequencing messages in strongly and eventually consistent systems
are described in the next two subsections. Most Delivery Service will use the
Strongly Consistent paradigm but this remains a choice that can be handled in
coordination with the client and advertized in the KeyPackages.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">However, note that a malicious Delivery Service could also reorder messages or
provide an inconsistent view to different users.  The "generation" counter in
MLS messages provides per-sender loss detection and ordering that cannot be
manipulated by the DS, but this does not provide complete protection against
partitioning.  A DS can cause a partition in the group by partitioning key
exchange messages; this can be detected only by out-of-band comparison (e.g.,
confirming that all clients have the same <code>epoch_authenticator</code> value`). A
mechanism for more robust protections is discussed in
<span>[<a href="#I-D.ietf-mls-extensions" class="cite xref">I-D.ietf-mls-extensions</a>]</span>.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">Other forms of Delivery Service misbehavior are still possible that are not easy
to detect. For instance, a Delivery Service can simply refuse to relay messages
to and from a given client. Without some sort of side information, other clients
cannot generally detect this form of Denial of Service (DoS) attack.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<div id="strongly-consistent">
<section id="section-5.2.1">
          <h4 id="name-strongly-consistent">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-strongly-consistent" class="section-name selfRef">Strongly Consistent</a>
          </h4>
<p id="section-5.2.1-1">With this approach, the Delivery Service ensures that some types of incoming
messages have a linear order and all members agree on that order.  The Delivery
Service is trusted to break ties when two members send a Commit message at the
same time.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">As an example, there could be an "ordering server" Delivery Service that
broadcasts all messages received to all users and ensures that all clients see
handshake messages in the same order. Clients that send a Commit would then wait
to apply it until it's broadcast back to them by the Delivery Service, assuming
they don't receive another Commit first.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">The Delivery Service can rely on the <code>epoch</code> and <code>content_type</code> fields of an
MLSMessage for providing an order only to handshake messages, and possibly even
filter or reject redundant Commit messages proactively to prevent them from
being broadcast. Alternatively, the Delivery Service could simply apply an order
to all messages and rely on clients to ignore redundant Commits.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eventually-consistent">
<section id="section-5.2.2">
          <h4 id="name-eventually-consistent">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-eventually-consistent" class="section-name selfRef">Eventually Consistent</a>
          </h4>
<p id="section-5.2.2-1">With this approach, the Delivery Service is built in a way that may be
significantly more available or performant than a strongly consistent system,
but offers weaker consistency guarantees. Messages may arrive to different
clients in different orders and with varying amounts of latency, which means
clients are responsible for reconciliation.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">This type of Delivery Service might arise, for example, when group members are
sending each message to each other member individually, or when a distributed
peer-to-peer network is used to broadcast messages.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">Upon receiving a Commit from the Delivery Service, clients can either:<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2-4">
<li id="section-5.2.2-4.1">
              <p id="section-5.2.2-4.1.1">Pause sending new messages for a short amount of time to account for a
reasonable degree of network latency and see if any other Commits are
received for the same epoch. If multiple Commits are received, the clients
can use a deterministic tie-breaking policy to decide which to accept, and
then resume sending messages as normal.<a href="#section-5.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-4.2">
              <p id="section-5.2.2-4.2.1">Accept the Commit immediately but keep a copy of the previous group state for
a short period of time. If another Commit for a past epoch is received,
clients use a deterministic tie-breaking policy to decide if they should
continue using the Commit they originally accepted or revert and use the
later one. Note that any copies of previous or forked group states must be
deleted within a reasonable amount of time to ensure the protocol provides
forward-secrecy.<a href="#section-5.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.2.2-5">If the Commit references an unknown proposal, group members may need to solicit
the Delivery Service or other group members individually for the contents of the
proposal.<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="functional-requirements">
<section id="section-6">
      <h2 id="name-functional-requirements">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-functional-requirements" class="section-name selfRef">Functional Requirements</a>
      </h2>
<p id="section-6-1">MLS is designed as a large-scale group messaging protocol and hence aims to
provide both performance and security (e.g. integrity and confidentiality)
to its users. Messaging systems that implement MLS provide support for
conversations involving two or more members, and aim to scale to groups with
tens of thousands of members, typically including many users using multiple devices.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="membership-changes">
<section id="section-6.1">
        <h3 id="name-membership-changes">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-membership-changes" class="section-name selfRef">Membership Changes</a>
        </h3>
<p id="section-6.1-1">MLS aims to provide agreement on group membership, meaning that all group
members have agreed on the list of current group members.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Some applications may wish to enforce ACLs to limit addition or removal of group
members, to privileged clients or users. Others may wish to require
authorization from the current group members or a subset thereof.  Such policies
can be implemented at the application layer, on top of MLS. Regardless, MLS does
not allow for or support addition or removal of group members without informing
all other members.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Membership of an MLS group is managed at the level of individual clients.  In
most cases, a client corresponds to a specific device used by a user. If a user
has multiple devices, the user will generally be represented in a group by
multiple clients (although applications could choose to have devices share
keying material).  If an application wishes to implement operations at the level
of users, it is up to the application to track which clients belong to a given
user and ensure that they are added / removed consistently.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">MLS provides two mechanisms for changing the membership of a group.  The primary
mechanism is for an authorized member of the group to send a Commit that adds or
removes other members.  The second mechanism is an "external join": A member of
the group publishes certain information about the group, which a new member can
use to construct an "external" Commit message that adds the new member to the
group.  (There is no similarly unilateral way for a member to leave the group;
they must be removed by a remaining member.)<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">With both mechanisms, changes to the membership are initiated from inside the
group.  When members perform changes directly, this is clearly the case.
External joins are authorized indirectly, in the sense that a member publishing
a GroupInfo object authorizes anyone to join who has access to the GroupInfo
object, subject to whatever access control policies the application applies
for external joins.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">Both types of joins are done via a Commit message, which could be
blocked by the DS or rejected by clients if the join is not authorized.  The
former approach requires that Commits be visible to the DS; the latter approach
requires that clients all share a consistent policy. In the unfortunate event
that an unauthorized member is able to join, MLS enables any member to remove
them.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">Application setup may also determine other criteria for membership validity. For
example, per-device signature keys can be signed by an identity key recognized
by other participants. If a certificate chain is used to authenticate device
signature keys, then revocation by the owner adds an alternative mechanism to prompt
membership removal.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.1-8">An MLS group's secrets change on every change of membership, so each client only
has access to the secrets used by the group while they are a member.  Messages
sent before a client joins or after they are removed are protected with keys
that are not accessible to the client.  Compromise of a member removed from a
group does not affect the security of messages sent after their removal.
Messages sent during the client's membership are also secure as long as the
client has properly implemented the MLS deletion schedule, which calls for the
secrets used to encrypt or decrypt a message to be deleted after use, along with
any secrets that could be used to derive them.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parallel-groups">
<section id="section-6.2">
        <h3 id="name-parallel-groups">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-parallel-groups" class="section-name selfRef">Parallel Groups</a>
        </h3>
<p id="section-6.2-1">Any user or client may have membership in several groups simultaneously.  The
set of members of any group may or may not form a subset of the members of
another group. MLS guarantees that the FS and PCS goals within a given group are
maintained and not weakened by user membership in multiple groups. However,
actions in other groups likewise do not strengthen the FS and PCS guarantees
within a given group, e.g., key updates within a given group following a device
compromise does not provide PCS healing in other groups; each group must be
updated separately to achieve these security objectives.  This also applies to
future groups that a member has yet to join, which are likewise unaffected by
updates performed in current groups.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Applications can strengthen connectivity among parallel groups by requiring
periodic key updates from a user across all groups in which they have
membership.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">MLS provides a pre-shared key (PSK) that can be used to link healing properties
among parallel groups.  For example, suppose a common member M of two groups A
and B has performed a key update in group A but not in group B.  The key update
provides PCS with regard to M in group A.  If a PSK is exported from group A and
injected into group B, then some of these PCS properties carry over to group B,
since the PSK and secrets derived from it are only known to the new, updated
version of M, not to the old, possibly compromised version of M.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="asynchronous-usage">
<section id="section-6.3">
        <h3 id="name-asynchronous-usage">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-asynchronous-usage" class="section-name selfRef">Asynchronous Usage</a>
        </h3>
<p id="section-6.3-1">No operation in MLS requires two distinct clients or members to be online
simultaneously. In particular, members participating in conversations protected
using MLS can update the group's keys, add or remove new members, and send
messages without waiting for another user's reply.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Messaging systems that implement MLS have to provide a transport layer for
delivering messages asynchronously and reliably.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-control">
<section id="section-6.4">
        <h3 id="name-access-control">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-access-control" class="section-name selfRef">Access Control</a>
        </h3>
<p id="section-6.4-1">Because all clients within a group (members) have access to the shared
cryptographic material, MLS protocol allows each member of the messaging group
to perform operations, However, every service/infrastructure has control over
policies applied to its own clients. Applications managing MLS clients can be
configured to allow for specific group operations. On the one hand, an
application could decide that a group administrator will be the only member to
perform add and remove operations. On the other hand, in many settings such as
open discussion forums, joining can be allowed for anyone.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">While MLS Application messages are always encrypted,
MLS handshake messages can be sent either encrypted (in an MLS
PrivateMessage) or unencrypted (in an MLS PublicMessage). Applications
may be designed such that intermediaries need to see handshake
messages, for example to enforce policy on which commits are allowed,
or to provide MLS ratchet tree data in a central location. If
handshake messages are unencrypted, it is especially important that
they be sent over a channel with strong transport encryption
(see <a href="#security-and-privacy-considerations" class="auto internal xref">Section 8</a>) in order to prevent external
attackers from monitoring the status of the group. Applications that
use unencrypted handshake messages may take additional steps to reduce
the amount of metadata that is exposed to the intermediary. Everything
else being equal, using encrypted handshake messages provides stronger
privacy properties than using unencrypted handshake messages,
as it prevents intermediaries from learning about the structure
of the group.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">If handshake messages are encrypted, any access
control policies must be applied at the client, so the application must ensure
that the access control policies are consistent across all clients to make sure
that they remain in sync.  If two different policies were applied, the clients
might not accept or reject a group operation and end-up in different
cryptographic states, breaking their ability to communicate.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4-4.1">
            <p id="section-6.4-4.1.1"><strong>RECOMMENDATION:</strong> Avoid using inconsistent access control policies in the
case of encrypted group operations.<a href="#section-6.4-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-5">MLS allows actors outside the group to influence the group in two ways: External
signers can submit proposals for changes to the group, and new joiners can use
an external join to add themselves to the group.  The <code>external_senders</code>
extension ensures that all members agree on which signers are allowed to send
proposals, but any other policies must be assured to be consistent as above.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4-6.1">
            <p id="section-6.4-6.1.1"><strong>RECOMMENDATION:</strong> Have an explicit group policy setting the conditions under
which external joins are allowed.<a href="#section-6.4-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="handling-authentication-failures">
<section id="section-6.5">
        <h3 id="name-handling-authentication-fai">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-handling-authentication-fai" class="section-name selfRef">Handling Authentication Failures</a>
        </h3>
<p id="section-6.5-1">Within an MLS group, every member is authenticated to every other member by
means of credentials issued and verified by the Authentication Service.  MLS
does not prescribe what actions, if any, an application should take in the event
that a group member presents an invalid credential.  For example, an application
may require such a member to be immediately evicted, or may allow some grace
period for the problem to be remediated. To avoid operational problems, it is
important for all clients in a group to have a consistent view of which
credentials in a group are valid, and how to respond to invalid credentials.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5-2.1">
            <p id="section-6.5-2.1.1"><strong>RECOMMENDATION:</strong> Have a uniform credential validation process to ensure
that all group members evaluate other members' credentials in the same way.<a href="#section-6.5-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5-3.1">
            <p id="section-6.5-3.1.1"><strong>RECOMMENDATION:</strong> Have a uniform policy for how invalid credentials are
handled.<a href="#section-6.5-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.5-4">In some authentication systems, it is possible for a previously-valid credential
to become invalid over time.  For example, in a system based on X.509
certificates, credentials can expire or be revoked.  The MLS update mechanisms
allow a client to replace an old credential with a new one. This is best done
before the old credential becomes invalid.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.5-5.1">
            <p id="section-6.5-5.1.1"><strong>RECOMMENDATION:</strong> Proactively rotate credentials, especially if a credential
is about to become invalid.<a href="#section-6.5-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="state-loss">
<section id="section-6.6">
        <h3 id="name-recovery-after-state-loss">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-recovery-after-state-loss" class="section-name selfRef">Recovery After State Loss</a>
        </h3>
<p id="section-6.6-1">Group members whose local MLS state is lost or corrupted can reinitialize their
state by re-joining the group as a new member and removing the member
representing their earlier state.  An application can require that a client
performing such a reinitialization prove its prior membership with a PSK that
was exported from the prevoius state.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">There are a few practical challenges to this approach.  For example, the
application will need to ensure that all members have the required PSK,
including any new members that have joined the group since the epoch in which
the PSK was issued.  And of course, if the PSK is lost or corrupted along with
the member's other state, then it cannot be used to recover.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
<p id="section-6.6-3">Reinitializing in this way does not provide the member with access to group
messages from during the state loss window, but enables proof of prior
membership in the group. Applications may choose various configurations for
providing lost messages to valid group members that are able to prove prior
membership.<a href="#section-6.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="support-for-multiple-devices">
<section id="section-6.7">
        <h3 id="name-support-for-multiple-device">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-support-for-multiple-device" class="section-name selfRef">Support for Multiple Devices</a>
        </h3>
<p id="section-6.7-1">It is typically expected for users within a group to own various devices. A new
device can be added to a group and be considered as a new client by the
protocol. This client will not gain access to the history even if it is owned by
someone who owns another member of the group.  MLS does not provide direct
support for restoring history in this case, but applications can elect to
provide such a mechanism outside of MLS.  Such mechanisms, if used, may reduce
the FS and PCS guarantees provided by MLS.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extensibility">
<section id="section-6.8">
        <h3 id="name-extensibility">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-extensibility" class="section-name selfRef">Extensibility</a>
        </h3>
<p id="section-6.8-1">The MLS protocol provides several extension points where additional information
can be provided.  Extensions to KeyPackages allow clients to disclose additional
information about their capabilities.  Groups can also have extension data
associated with them, and the group agreement properties of MLS will confirm
that all members of the group agree on the content of these extensions.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application-data-framing-and-type-advertisements">
<section id="section-6.9">
        <h3 id="name-application-data-framing-an">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-application-data-framing-an" class="section-name selfRef">Application Data Framing and Type Advertisements</a>
        </h3>
<p id="section-6.9-1">Application messages carried by MLS are opaque to the protocol; they can contain
arbitrary data. Each application which uses MLS needs to define the format of
its <code>application_data</code> and any mechanism necessary to determine the format of
that content over the lifetime of an MLS group. In many applications this means
managing format migrations for groups with multiple members who may each be
offline at unpredictable times.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.9-2.1">
            <p id="section-6.9-2.1.1"><strong>RECOMMENDATION:</strong> Use the default content mechanism defined in
<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-extensions-03#section-2.3" class="relref">Section 2.3</a> of [<a href="#I-D.ietf-mls-extensions" class="cite xref">I-D.ietf-mls-extensions</a>]</span>, unless the specific application defines another
mechanism which more appropriately addresses the same requirements for that
application of MLS.<a href="#section-6.9-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.9-3">The MLS framing for application messages also provides a field where clients can
send information that is authenticated but not encrypted.  Such information can
be used by servers that handle the message, but group members are assured that
it has not been tampered with.<a href="#section-6.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="federation">
<section id="section-6.10">
        <h3 id="name-federation">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-federation" class="section-name selfRef">Federation</a>
        </h3>
<p id="section-6.10-1">The protocol aims to be compatible with federated environments. While this
document does not specify all necessary mechanisms required for federation,
multiple MLS implementations can interoperate to form federated systems if they
use compatible authentication mechanisms, ciphersuites, application content, and
infrastructure functionalities. Federation is described in more detail in
<span>[<a href="#I-D.ietf-mls-federation" class="cite xref">I-D.ietf-mls-federation</a>]</span>.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compatibility-with-future-versions-of-mls">
<section id="section-6.11">
        <h3 id="name-compatibility-with-future-v">
<a href="#section-6.11" class="section-number selfRef">6.11. </a><a href="#name-compatibility-with-future-v" class="section-name selfRef">Compatibility with Future Versions of MLS</a>
        </h3>
<p id="section-6.11-1">It is important that multiple versions of MLS be able to coexist in the
future. Thus, MLS offers a version negotiation mechanism; this mechanism
prevents version downgrade attacks where an attacker would actively rewrite
messages with a lower protocol version than the ones originally offered by the
endpoints. When multiple versions of MLS are available, the negotiation protocol
guarantees that the version agreed upon will be the highest version supported in
common by the group.<a href="#section-6.11-1" class="pilcrow">¶</a></p>
<p id="section-6.11-2">In MLS 1.0, the creator of the group is responsible for selecting the best
ciphersuite supported across clients. Each client is able to verify availability
of protocol version, ciphersuites and extensions at all times once he has at
least received the first group operation message.<a href="#section-6.11-2" class="pilcrow">¶</a></p>
<p id="section-6.11-3">Each member of an MLS group advertises the protocol functionality they support.
These capability advertisements can be updated over time, e.g., if client
software is updated while the client is a member of a group. Thus, in addition
to preventing downgrade attacks, the members of a group can also observe when it
is safe to upgrade to a new ciphersuite or protocol version.<a href="#section-6.11-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-requirements">
<section id="section-7">
      <h2 id="name-operational-requirements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-operational-requirements" class="section-name selfRef">Operational Requirements</a>
      </h2>
<p id="section-7-1">MLS is a security layer that needs to be integrated with an application. A
fully-functional deployment of MLS will have to make a number of decisions about
how MLS is configured and operated.  Deployments that wish to interoperate will
need to make compatible decisions. This section lists all of the dependencies of
an MLS deployment that are external to the protocol specification, but would
still need to be aligned within a given MLS deployment, or for two deployments
to potentially interoperate.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The protocol has a built-in ability to negotiate protocol versions,
ciphersuites, extensions, credential types, and additional proposal types. For
two deployments to interoperate, they must have overlapping support in each of
these categories. The <code>required_capabilities</code> extension (Section 7.2 of
<span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>) can promote interoperability with a wider set of clients by
ensuring that certain functionality continues to be supported by a group, even
if the clients in the group aren't currently relying on it.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">MLS relies on the following network services, that need to be compatible in
order for two different deployments based on them to interoperate.<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">
          <p id="section-7-4.1.1">An <strong>Authentication Service</strong>, described fully in <a href="#authentication-service" class="auto internal xref">Section 4</a>,
defines the types of credentials which may be used in a deployment and
provides methods for:<a href="#section-7-4.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-4.1.2">
<li id="section-7-4.1.2.1">
              <p id="section-7-4.1.2.1.1">Issuing new credentials with a relevant credential lifetime,<a href="#section-7-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7-4.1.2.2">
              <p id="section-7-4.1.2.2.1">Validating a credential against a reference identifier,<a href="#section-7-4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7-4.1.2.3">
              <p id="section-7-4.1.2.3.1">Validating whether or not two credentials represent the same client, and<a href="#section-7-4.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7-4.1.2.4">
              <p id="section-7-4.1.2.4.1">Optionally revoking credentials which are no longer authorized.<a href="#section-7-4.1.2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</li>
        <li class="normal" id="section-7-4.2">
          <p id="section-7-4.2.1">A <strong>Delivery Service</strong>, described fully in <a href="#delivery-service" class="auto internal xref">Section 5</a>, provides
methods for:<a href="#section-7-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-4.2.2">
<li id="section-7-4.2.2.1">
              <p id="section-7-4.2.2.1.1">Delivering messages for a group to all members in the group.<a href="#section-7-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7-4.2.2.2">
              <p id="section-7-4.2.2.2.1">Delivering Welcome messages to new members of a group.<a href="#section-7-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7-4.2.2.3">
              <p id="section-7-4.2.2.3.1">Uploading new KeyPackages for a user's own clients.<a href="#section-7-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7-4.2.2.4">
              <p id="section-7-4.2.2.4.1">Downloading KeyPackages for specific clients. Typically, KeyPackages are
used once and consumed.<a href="#section-7-4.2.2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</li>
        <li class="normal" id="section-7-4.3">
          <p id="section-7-4.3.1">Additional services may or may not be required depending on the application
design:<a href="#section-7-4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.3.2.1">
              <p id="section-7-4.3.2.1.1">In cases where group operations are not encrypted, the DS has the ability to
observe and maintain a copy of the public group state. In particular, this
is useful for clients that do not have the ability to send the full public
state in a Welcome message when inviting auser or for client that need to
recover from a loss of their state. Such public state can contain privacy
sensitive information such as group members' credentials and related public
keys, hence services need to be carefully evaluate the privacy impact of
storing this data on the DS.<a href="#section-7-4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-4.3.2.2">
              <p id="section-7-4.3.2.2.1">If external joiners are allowed, there must be a method to publish a
serialized <code>GroupInfo</code> object (with an <code>external_pub</code> extension) that
corresponds to a specific group and epoch, and keep that object in sync with
the state of the group.<a href="#section-7-4.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-4.3.2.3">
              <p id="section-7-4.3.2.3.1">If an application chooses not to allow external joining, it may
instead provide a method for external users to solicit group members (or a
designated service) to add them to a group.<a href="#section-7-4.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-4.3.2.4">
              <p id="section-7-4.3.2.4.1">If the application uses PSKs that members of a group may not have access to
(e.g., to control entry into the group or to prove membership in the group
in the past, as in <a href="#state-loss" class="auto internal xref">Section 6.6</a>) there must be a method for distributing
these PSKs to group members who might not have them, for instance if they
joined the group after the PSK was generated.<a href="#section-7-4.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-4.3.2.5">
              <p id="section-7-4.3.2.5.1">If an application wishes to detect and possibly discipline members that send
malformed commits with the intention of corrupting a group's state, there
must be a method for reporting and validating malformed commits.<a href="#section-7-4.3.2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-7-5">MLS requires the following parameters to be defined, which must be the same for
two implementations to interoperate:<a href="#section-7-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-6.1">
          <p id="section-7-6.1.1">The maximum total lifetime that is acceptable for a KeyPackage.<a href="#section-7-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-6.2">
          <p id="section-7-6.2.1">How long to store the resumption PSK for past epochs of a group.<a href="#section-7-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-6.3">
          <p id="section-7-6.3.1">The degree of tolerance that's allowed for out-of-order message delivery:<a href="#section-7-6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-6.3.2.1">
              <p id="section-7-6.3.2.1.1">How long to keep unused nonce and key pairs for a sender<a href="#section-7-6.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-6.3.2.2">
              <p id="section-7-6.3.2.2.1">A maximum number of unused key pairs to keep.<a href="#section-7-6.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-6.3.2.3">
              <p id="section-7-6.3.2.3.1">A maximum number of steps that clients will move a secret tree ratchet
forward in response to a single message before rejecting it.<a href="#section-7-6.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-6.3.2.4">
              <p id="section-7-6.3.2.4.1">Whether to buffer messages that aren't able to be understood yet due to
other messages not arriving first, and if so, how many and for how long. For
example, Commit messages that arrive before a proposal they reference, or
application messages that arrive before the Commit starting an epoch.<a href="#section-7-6.3.2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-7-7">If implementations differ in these parameters, they will interoperate to some
extent but may experience unexpected failures in certain situations, such as
extensive message reordering.<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">MLS provides the following locations where an application may store arbitrary
data. The format and intention of any data in these locations must align for two
deployments to interoperate:<a href="#section-7-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-9.1">
          <p id="section-7-9.1.1">Application data, sent as the payload of an encrypted message.<a href="#section-7-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-9.2">
          <p id="section-7-9.2.1">Additional authenticated data, sent unencrypted in an otherwise encrypted
message.<a href="#section-7-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-9.3">
          <p id="section-7-9.3.1">Group IDs, as decided by group creators and used to uniquely identify a group.<a href="#section-7-9.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-9.4">
          <p id="section-7-9.4.1">Application-level identifiers of public key material (specifically
the <code>application_id</code> extension as defined in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-5.3.3" class="relref">Section 5.3.3</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>).<a href="#section-7-9.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-10">MLS requires the following policies to be defined, which restrict the set of
acceptable behavior in a group. These policies must be consistent between
deployments for them to interoperate:<a href="#section-7-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-11.1">
          <p id="section-7-11.1.1">A policy on which ciphersuites are acceptable.<a href="#section-7-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-11.2">
          <p id="section-7-11.2.1">A policy on any mandatory or forbidden MLS extensions.<a href="#section-7-11.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-11.3">
          <p id="section-7-11.3.1">A policy on when to send proposals and commits in plaintext instead of
encrypted.<a href="#section-7-11.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-11.4">
          <p id="section-7-11.4.1">A policy for which proposals are valid to have in a commit, including but not
limited to:<a href="#section-7-11.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-11.4.2.1">
              <p id="section-7-11.4.2.1.1">When a member is allowed to add or remove other members of the group.<a href="#section-7-11.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-11.4.2.2">
              <p id="section-7-11.4.2.2.1">When, and under what circumstances, a reinitialization proposal is allowed.<a href="#section-7-11.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-11.4.2.3">
              <p id="section-7-11.4.2.3.1">When proposals from external senders are allowed and how to authorize
those proposals.<a href="#section-7-11.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-11.4.2.4">
              <p id="section-7-11.4.2.4.1">When external joiners are allowed and how to authorize those external
commits.<a href="#section-7-11.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-11.4.2.5">
              <p id="section-7-11.4.2.5.1">Which other proposal types are allowed.<a href="#section-7-11.4.2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-7-11.5">
          <p id="section-7-11.5.1">A policy of when members should commit pending proposals in a group.<a href="#section-7-11.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-11.6">
          <p id="section-7-11.6.1">A policy of how to protect and share the GroupInfo objects needed for
external joins.<a href="#section-7-11.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-11.7">
          <p id="section-7-11.7.1">A policy for when two credentials represent the same client. Note that many
credentials may be issued attesting the same identity but for different
signature keys, because each credential corresponds to a different client
owned by the same application user. However, one device may control multiple
signature keys -- for instance if they have keys corresponding to multiple
overlapping time periods -- but should still only be considered a single
client.<a href="#section-7-11.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-11.8">
          <p id="section-7-11.8.1">A policy on how long to allow a member to stay in a group without updating its
leaf keys before removing them.<a href="#section-7-11.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-12">Finally, there are some additional application-defined behaviors that are
partially an individual application's decision but may overlap with
interoperability:<a href="#section-7-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-13.1">
          <p id="section-7-13.1.1">When and how to pad messages.<a href="#section-7-13.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-13.2">
          <p id="section-7-13.2.1">When to send a reinitialization proposal.<a href="#section-7-13.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-13.3">
          <p id="section-7-13.3.1">How often clients should update their leaf keys.<a href="#section-7-13.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-13.4">
          <p id="section-7-13.4.1">Whether to prefer sending full commits or partial/empty commits.<a href="#section-7-13.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-13.5">
          <p id="section-7-13.5.1">Whether there should be a <code>required_capabilities</code> extension in groups.<a href="#section-7-13.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="security-and-privacy-considerations">
<section id="section-8">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and Privacy Considerations</a>
      </h2>
<p id="section-8-1">MLS adopts the Internet threat model <span>[<a href="#RFC3552" class="cite xref">RFC3552</a>]</span> and therefore assumes that the
attacker has complete control of the network. It is intended to provide the
security services described in <a href="#intended-security-guarantees" class="auto internal xref">Section 8.2</a> in the face of
attackers who can:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">Monitor the entire network.<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">Read unprotected messages.<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.3">
          <p id="section-8-2.3.1">Can generate, inject and delete any message in the unprotected
transport layer.<a href="#section-8-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-3">While MLS should be run over a secure transport such as QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span> or TLS
<span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, the security guarantees of MLS do not depend on the
transport. This departs from the usual design practice of trusting the transport
because MLS is designed to provide security even in the face of compromised
network elements, especially the DS.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Generally, MLS is designed under the assumption that the transport layer is
present to keep metadata private from network observers, while the MLS protocol
provides confidentiality, integrity, and authentication guarantees for the
application data (which could pass through multiple systems). Additional
properties such as partial anonymity or deniability could also be achieved in
specific architecture designs.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">In addition, these guarantees are intended to degrade gracefully in the presence
of compromise of the transport security links as well as of both clients and
elements of the messaging system, as described in the remainder of this section.<a href="#section-8-5" class="pilcrow">¶</a></p>
<div id="assumptions-on-transport-security-links">
<section id="section-8.1">
        <h3 id="name-assumptions-on-transport-se">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-assumptions-on-transport-se" class="section-name selfRef">Assumptions on Transport Security Links</a>
        </h3>
<p id="section-8.1-1">As discussed above, MLS provides the highest level of security when its messages
are delivered over an encrypted transport.  The main use of the secure transport
layer for MLS is to protect the already limited amount of metadata. Very little
information is contained in the unencrypted header of the MLS protocol message
format for group operation messages, and application messages are always
encrypted in MLS.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1"><strong>RECOMMENDATION:</strong> Use transports that provide reliability and metadata
confidentiality whenever possible, e.g., by transmitting MLS messages over
a protocol such as TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> or QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>.<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-3">MLS avoids needing to send the full list of recipients to the server for
dispatching messages because that list could potentially contain tens of
thousands of recipients. Header metadata in MLS messages typically consists of
an opaque <code>group_id</code>, a numerical value to determine the epoch of the group (the
number of changes that have been made to the group), and whether the message is
an application message, a proposal, or a commit.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">Even though some of this metadata information does not consist of sensitive
information, in correlation with other data a network observer might be able to
reconstruct sensitive information. Using a secure channel to transfer this
information will prevent a network attacker from accessing this MLS protocol
metadata if it cannot compromise the secure channel.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<div id="integrity-and-authentication-of-custom-metadata">
<section id="section-8.1.1">
          <h4 id="name-integrity-and-authenticatio">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-integrity-and-authenticatio" class="section-name selfRef">Integrity and Authentication of Custom Metadata</a>
          </h4>
<p id="section-8.1.1-1">MLS provides an authenticated "Additional Authenticated Data" (AAD) field for
applications to make data available outside a PrivateMessage, while
cryptographically binding it to the message.<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1.1-2.1">
              <p id="section-8.1.1-2.1.1"><strong>RECOMMENDATION:</strong> Use the "Additional Authenticated Data" field of the
PrivateMessage instead of using other unauthenticated means of sending
metadata throughout the infrastructure. If the data should be kept private, the
infrastructure should use encrypted Application messages instead.<a href="#section-8.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="metadata-protection-for-unencrypted-group-operations">
<section id="section-8.1.2">
          <h4 id="name-metadata-protection-for-une">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-metadata-protection-for-une" class="section-name selfRef">Metadata Protection for Unencrypted Group Operations</a>
          </h4>
<p id="section-8.1.2-1">Having no secure channel to exchange MLS messages can have a serious impact on
privacy when transmitting unencrypted group operation messages. Observing the
contents and signatures of the group operation messages may lead an adversary to
extract information about the group membership.<a href="#section-8.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1.2-2.1">
              <p id="section-8.1.2-2.1.1"><strong>RECOMMENDATION:</strong> Never use the unencrypted mode for group operations
without using a secure channel for the transport layer.<a href="#section-8.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="dos-protection">
<section id="section-8.1.3">
          <h4 id="name-dos-protection">
<a href="#section-8.1.3" class="section-number selfRef">8.1.3. </a><a href="#name-dos-protection" class="section-name selfRef">DoS protection</a>
          </h4>
<p id="section-8.1.3-1">In general we do not consider Denial of Service (DoS) resistance to be the
responsibility of the protocol. However, it should not be possible for anyone
aside from the Delivery Service to perform a trivial DoS attack from which it is
hard to recover. This can be achieved through the secure transport layer.<a href="#section-8.1.3-1" class="pilcrow">¶</a></p>
<p id="section-8.1.3-2">In the centralized setting, DoS protection can typically be performed by using
tickets or cookies which identify users to a service for a certain number of
connections. Such a system helps in preventing anonymous clients from sending
arbitrary numbers of group operation messages to the Delivery Service or the MLS
clients.<a href="#section-8.1.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1.3-3.1">
              <p id="section-8.1.3-3.1.1"><strong>RECOMMENDATION:</strong> Use credentials uncorrellated with specific users to help
prevent DoS attacks, in a privacy preserving manner. Note that the privacy of
these mechanisms has to be adjusted in accordance with the privacy expected
from secure transport links. (See more discussion in the next section.)<a href="#section-8.1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="message-suppression-and-error-correction">
<section id="section-8.1.4">
          <h4 id="name-message-suppression-and-err">
<a href="#section-8.1.4" class="section-number selfRef">8.1.4. </a><a href="#name-message-suppression-and-err" class="section-name selfRef">Message Suppression and Error Correction</a>
          </h4>
<p id="section-8.1.4-1">As noted above, MLS is designed to provide some robustness in the face of
tampering within the secure transport, i.e., tampering by the Delivery Service.
The confidentiality and authenticity properties of MLS prevent the DS from
reading or writing messages.  MLS also provides a few tools for detecting
message suppression, with the caveat that message suppression cannot always be
distinguished from transport failure.<a href="#section-8.1.4-1" class="pilcrow">¶</a></p>
<p id="section-8.1.4-2">Each encrypted MLS message carries a "generation" number which is a per-sender
incrementing counter.  If a group member observes a gap in the generation
sequence for a sender, then they know that they have missed a message from that
sender.  MLS also provides a facility for group members to send authenticated
acknowledgments of application messages received within a group.<a href="#section-8.1.4-2" class="pilcrow">¶</a></p>
<p id="section-8.1.4-3">As discussed in <a href="#delivery-service" class="auto internal xref">Section 5</a>, the Delivery Service is trusted to select
the single Commit message that is applied in each epoch from among the ones sent
by group members.  Since only one Commit per epoch is meaningful, it's not
useful for the DS to transmit multiple Commits to clients.  The risk remains
that the DS will use the ability maliciously.<a href="#section-8.1.4-3" class="pilcrow">¶</a></p>
<p id="section-8.1.4-4">While it is difficult or impossible to prevent a network adversary from
suppressing payloads in transit, in certain infrastructures such as banks or
governments settings, unidirectional transports can be used and be enforced via
electronic or physical devices such as diodes. This can lead to payload
corruption which does not affect the security or privacy properties of the MLS
protocol but does affect the reliability of the service. In that case specific
measures can be taken to ensure the appropriate level of redundancy and quality
of service for MLS.<a href="#section-8.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="intended-security-guarantees">
<section id="section-8.2">
        <h3 id="name-intended-security-guarantee">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-intended-security-guarantee" class="section-name selfRef">Intended Security Guarantees</a>
        </h3>
<p id="section-8.2-1">MLS aims to provide a number of security guarantees, covering authentication, as
well as confidentiality guarantees to different degrees in different scenarios.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div id="message-secrecy-authentication">
<section id="section-8.2.1">
          <h4 id="name-message-secrecy-and-authent">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-message-secrecy-and-authent" class="section-name selfRef">Message Secrecy and Authentication</a>
          </h4>
<p id="section-8.2.1-1">MLS enforces the encryption of application messages and thus generally
guarantees authentication and confidentiality of application messages sent in a
group.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">In particular, this means that only other members of a given group can decrypt
the payload of a given application message, which includes information about the
sender of the message.<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1-3">Similarly, group members receiving a message from another group member can
authenticate that group member as the sender of the message and verify the
message's integrity.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
<p id="section-8.2.1-4">Message content can be deniable if the signature keys are exchanged over a
deniable channel prior to signing messages.<a href="#section-8.2.1-4" class="pilcrow">¶</a></p>
<p id="section-8.2.1-5">Depending on the group settings, handshake messages can be encrypted as well. If
that is the case, the same security guarantees apply.<a href="#section-8.2.1-5" class="pilcrow">¶</a></p>
<p id="section-8.2.1-6">MLS optionally allows the addition of padding to messages, mitigating the amount
of information leaked about the length of the plaintext to an observer on the
network.<a href="#section-8.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fs-and-pcs">
<section id="section-8.2.2">
          <h4 id="name-forward-and-post-compromise">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-forward-and-post-compromise" class="section-name selfRef">Forward and Post-Compromise Security</a>
          </h4>
<p id="section-8.2.2-1">MLS provides additional protection regarding secrecy of past messages and future
messages. These cryptographic security properties are Forward Secrecy (FS) and
Post-Compromise Security (PCS).<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-2">FS means that access to all encrypted traffic history combined with access to
all current keying material on clients will not defeat the secrecy properties of
messages older than the oldest key of the compromised client.  Note that this
means that clients have the extremely important role of deleting appropriate
keys as soon as they have been used with the expected message, otherwise the
secrecy of the messages and the security for MLS is considerably weakened.<a href="#section-8.2.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2.2-3">PCS means that if a group member's state is compromised at some time t1 but the
group member subsequently performs an update at some time t2, then all MLS
guarantees apply to messages sent by the member after time t2, and by other
members after they have processed the update. For example, if an attacker learns
all secrets known to Alice at time t1, including both Alice's long-term secret
keys and all shared group keys, but Alice performs a key update at time t2, then
the attacker is unable to violate any of the MLS security properties after the
updates have been processed.<a href="#section-8.2.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2.2-4">Both of these properties are satisfied even against compromised DSs and ASs in
the case where some other mechanism for verifying keys is in use, such as Key
Transparency <span>[<a href="#KT" class="cite xref">KT</a>]</span>.<a href="#section-8.2.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2.2-5">Confidentiality is mainly ensured on the client side.  Because Forward Secrecy
(FS) and Post-Compromise Security (PCS) rely on the active deletion and
replacement of keying material, any client which is persistently offline may
still be holding old keying material and thus be a threat to both FS and PCS if
it is later compromised.<a href="#section-8.2.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2.2-6">MLS partially defends against this problem by active members including
freshness, however not much can be done on the inactive side especially in the
case where the client has not processed messages.<a href="#section-8.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.2.2-7.1">
              <p id="section-8.2.2-7.1.1"><strong>RECOMMENDATION:</strong> Mandate key updates from clients that are not otherwise
sending messages and evict clients which are idle for too long.<a href="#section-8.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.2.2-8">These recommendations will reduce the ability of idle compromised clients to
decrypt a potentially long set of messages that might have followed the point of
the compromise.<a href="#section-8.2.2-8" class="pilcrow">¶</a></p>
<p id="section-8.2.2-9">The precise details of such mechanisms are a matter of local policy and beyond
the scope of this document.<a href="#section-8.2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Non-Repudiation-vs-Deniability">
<section id="section-8.2.3">
          <h4 id="name-non-repudiation-vs-deniabil">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-non-repudiation-vs-deniabil" class="section-name selfRef">Non-Repudiation vs Deniability</a>
          </h4>
<p id="section-8.2.3-1">MLS provides strong authentication within a group, such that a group member
cannot send a message that appears to be from another group member.
Additionally, some services require that a recipient be able to prove to the
service provider that a message was sent by a given client, in order to report
abuse. MLS supports both of these use cases. In some deployments, these services
are provided by mechanisms which allow the receiver to prove a message's origin
to a third party. This is often called "non-repudiation".<a href="#section-8.2.3-1" class="pilcrow">¶</a></p>
<p id="section-8.2.3-2">Roughly speaking, "deniability" is the opposite of "non-repudiation", i.e., the
property that it is impossible to prove to a third party that a message was sent
by a given sender.  MLS does not make any claims with regard to deniability.  It
may be possible to operate MLS in ways that provide certain deniability
properties, but defining the specific requirements and resulting notions of
deniability requires further analysis.<a href="#section-8.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="associating-a-users-clients">
<section id="section-8.2.4">
          <h4 id="name-associating-a-users-clients">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-associating-a-users-clients" class="section-name selfRef">Associating a User's Clients</a>
          </h4>
<p id="section-8.2.4-1">When the same user uses multiple clients, it may be possible for other members
of a group to recognize all of those clients as belonging to the same user.  For
example, all of a user's clients might present credentials authenticating the
user's identity.  This association among devices might be considered a leak of
private information.  The remainder of this section describes several approaches
for addressing this.<a href="#section-8.2.4-1" class="pilcrow">¶</a></p>
<p id="section-8.2.4-2">This risk only arises when the leaf nodes for the clients in question provide
data that can be used to correlate the clients.  So one way to mitigate this
risk is by only doing client-level authentication within MLS. If user-level
authentication is still desirable, the application would have to provide it
through some other mechanism.<a href="#section-8.2.4-2" class="pilcrow">¶</a></p>
<p id="section-8.2.4-3">It is also possible to maintain user-level authentication while hiding
information about the clients that a user owns.  This can be done by having the
clients share cryptographic state, so that they appear as a single client within
the MLS group.  The application would need to provide a synchronization
mechanism so that the clients' state remained consistent across changes to the
MLS group.<a href="#section-8.2.4-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.2.4-4.1">
              <p id="section-8.2.4-4.1.1"><strong>RECOMMENDATION:</strong> Avoid sharing cryptographic state between clients to
improve resilience against compromises.  An attacker could use one compromised
device to establish ownership of a state across other devices and reduce the
ability of the user to recover.<a href="#section-8.2.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="endpoint-compromise">
<section id="section-8.3">
        <h3 id="name-endpoint-compromise">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-endpoint-compromise" class="section-name selfRef">Endpoint Compromise</a>
        </h3>
<p id="section-8.3-1">The MLS protocol adopts a threat model which includes multiple forms of
endpoint/client compromise. While adversaries are in a strong position if
they have compromised an MLS client, there are still situations where security
guarantees can be recovered thanks to the PCS properties achieved by the MLS
protocol.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">In this section we will explore the consequences and recommendations regarding
the following compromise scenarios:<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-3.1">
            <p id="section-8.3-3.1.1">The attacker has access to a symmetric encryption key<a href="#section-8.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.2">
            <p id="section-8.3-3.2.1">The attacker has access to a application ratchet secret<a href="#section-8.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.3">
            <p id="section-8.3-3.3.1">The attacker has access to the group secrets for one group<a href="#section-8.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.4">
            <p id="section-8.3-3.4.1">The attacker has access to a signature oracle for any group<a href="#section-8.3-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.5">
            <p id="section-8.3-3.5.1">The attacker has access to the signature key for one group<a href="#section-8.3-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.6">
            <p id="section-8.3-3.6.1">The attacker has access to all secrets of a user for all groups (full state
compromise)<a href="#section-8.3-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="symmetric-key-compromise">
<section id="section-8.3.1">
          <h4 id="name-compromise-of-symmetric-key">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-compromise-of-symmetric-key" class="section-name selfRef">Compromise of Symmetric Keying Material</a>
          </h4>
<p id="section-8.3.1-1">As described above, each MLS epoch creates a new Group Secret.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2">These group secrets are then used to create a per-sender Ratchet Secret, which
in turn is used to create a per-sender with additional data (AEAD) <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span>
key that is then used to encrypt MLS Plaintext messages.  Each time a message is
sent, the Ratchet Secret is used to create a new Ratchet Secret and a new
corresponding AEAD key.  Because of the properties of the key derivation
function, it is not possible to compute a Ratchet Secret from its corresponding
AEAD key or compute Ratchet Secret n-1 from Ratchet Secret n.<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
<p id="section-8.3.1-3">Below, we consider the compromise of each of these pieces of keying material in
turn, in ascending order of severity.  While this is a limited kind of
compromise, it can be realistic in cases of implementation vulnerabilities where
only part of the memory leaks to the adversary.<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
<div id="compromise-of-aead-keys">
<section id="section-8.3.1.1">
            <h5 id="name-compromise-of-aead-keys">
<a href="#section-8.3.1.1" class="section-number selfRef">8.3.1.1. </a><a href="#name-compromise-of-aead-keys" class="section-name selfRef">Compromise of AEAD Keys</a>
            </h5>
<p id="section-8.3.1.1-1">In some circumstances, adversaries may have access to specific AEAD keys and
nonces which protect an Application or a Group Operation message. Compromise of
these keys allows the attacker to decrypt the specific message encrypted with
that key but no other; because the AEAD keys are derived from the Ratchet
Secret, it cannot generate the next Ratchet Secret and hence not the next AEAD
key.<a href="#section-8.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1.1-2">In the case of an Application message, an AEAD key compromise means that the
encrypted application message will be leaked as well as the signature over that
message. This means that the compromise has both confidentiality and privacy
implications on the future AEAD encryptions of that chain.  In the case of a
Group Operation message, only the privacy is affected, as the signature is
revealed, because the secrets themselves are protected by HPKE encryption.  Note
that under that compromise scenario, authentication is not affected in either of
these cases.  As every member of the group can compute the AEAD keys for all the
chains (they have access to the Group Secrets) in order to send and receive
messages, the authentication provided by the AEAD encryption layer of the common
framing mechanism is weak. Successful decryption of an AEAD encrypted message
only guarantees that some member of the group sent the message.<a href="#section-8.3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-8.3.1.1-3">Compromise of the AEAD keys allows the attacker to send an encrypted message
using that key, but cannot send a message to a group which appears to be from
any valid client since they cannot forge the signature. This applies to all the
forms of symmetric key compromise described in <a href="#symmetric-key-compromise" class="auto internal xref">Section 8.3.1</a>.<a href="#section-8.3.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compromise-of-ratchet-secret-material">
<section id="section-8.3.1.2">
            <h5 id="name-compromise-of-ratchet-secre">
<a href="#section-8.3.1.2" class="section-number selfRef">8.3.1.2. </a><a href="#name-compromise-of-ratchet-secre" class="section-name selfRef">Compromise of Ratchet Secret material</a>
            </h5>
<p id="section-8.3.1.2-1">When a Ratchet Secret is compromised, the adversary can compute both the current
AEAD keys for a given sender as well as any future keys for that sender in this
epoch. Thus, it can decrypt current and future messages by the corresponding
sender. However, because it does not have previous Ratchet Secrets, it cannot
decrypt past messages as long as those secrets and keys have been deleted.<a href="#section-8.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1.2-2">Because of its Forward Secrecy guarantees, MLS will also retain secrecy of all
other AEAD keys generated for <em>other</em> MLS clients, outside this dedicated chain
of AEAD keys and nonces, even within the epoch of the compromise.  MLS provides
Post-Compromise Security against an active adaptive attacker across epochs for
AEAD encryption, which means that as soon as the epoch is changed, if the
attacker does not have access to more secret material they won't be able to
access any protected messages from future epochs.<a href="#section-8.3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compromise-of-the-group-secrets-of-a-single-group-for-one-or-more-group-epochs">
<section id="section-8.3.1.3">
            <h5 id="name-compromise-of-the-group-sec">
<a href="#section-8.3.1.3" class="section-number selfRef">8.3.1.3. </a><a href="#name-compromise-of-the-group-sec" class="section-name selfRef">Compromise of the Group Secrets of a single group for one or more group epochs</a>
            </h5>
<p id="section-8.3.1.3-1">An adversary who gains access to a set of Group secrets--as when a member of the
group is compromised--is significantly more powerful. In this section, we
consider the case where the signature keys are not compromised, which can occur
if the attacker has access to part of the memory containing the group secrets
but not to the signature keys which might be stored in a secure enclave.<a href="#section-8.3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1.3-2">In this scenario, the adversary gains the ability to compute any number of
Ratchet Secrets for the epoch and their corresponding AEAD encryption keys and
thus can encrypt and decrypt all messages for the compromised epochs.<a href="#section-8.3.1.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3.1.3-3">If the adversary is passive, it is expected from the PCS properties of the MLS
protocol that, as soon as the compromised party remediates the compromise and
sends an honest Commit message, the next epochs will provide message secrecy.<a href="#section-8.3.1.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3.1.3-4">If the adversary is active, the adversary can engage in the protocol itself and
perform updates on behalf of the compromised party with no ability for an honest
group to recover message secrecy. However, MLS provides PCS against active
adaptive attackers through its Remove group operation. This means that, as long
as other members of the group are honest, the protocol will guarantee message
secrecy for all messages exchanged in the epochs after the compromised party has
been removed.<a href="#section-8.3.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="compromise-by-an-active-adversary-with-the-ability-to-sign-messages">
<section id="section-8.3.2">
          <h4 id="name-compromise-by-an-active-adv">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-compromise-by-an-active-adv" class="section-name selfRef">Compromise by an active adversary with the ability to sign messages</a>
          </h4>
<p id="section-8.3.2-1">If an active adversary has compromised an MLS client and can sign messages, two
different settings emerge. In the strongest compromise scenario, the attacker
has access to the signing key and can forge authenticated messages. In a weaker,
yet realistic scenario, the attacker has compromised a client but the client
signature keys are protected with dedicated hardware features which do not allow
direct access to the value of the private key and instead provide a signature
API.<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2-2">When considering an active adaptive attacker with access to a signature oracle,
the compromise scenario implies a significant impact on both the secrecy and
authentication guarantees of the protocol, especially if the attacker also has
access to the group secrets. In that case both secrecy and authentication are
broken.  The attacker can generate any message, for the current and future
epochs, until the compromise is remediated and the formerly compromised client
sends an honest update.<a href="#section-8.3.2-2" class="pilcrow">¶</a></p>
<p id="section-8.3.2-3">Note that under this compromise scenario, the attacker can perform all
operations which are available to a legitimate client even without access to the
actual value of the signature key.<a href="#section-8.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compromise-of-the-authentication-with-access-to-a-signature-key">
<section id="section-8.3.3">
          <h4 id="name-compromise-of-the-authentic">
<a href="#section-8.3.3" class="section-number selfRef">8.3.3. </a><a href="#name-compromise-of-the-authentic" class="section-name selfRef">Compromise of the authentication with access to a signature key</a>
          </h4>
<p id="section-8.3.3-1">The difference between having access to the value of the signature key and only
having access to a signing oracle is not about the ability of an active adaptive
network attacker to perform different operations during the time of the
compromise, the attacker can perform every operation available to a legitimate
client in both cases.<a href="#section-8.3.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3.3-2">There is a significant difference, however in terms of recovery after a
compromise.<a href="#section-8.3.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3.3-3">Because of the PCS guarantees provided by the MLS protocol, when a previously
compromised client recovers from compromise and performs an honest Commit, both
secrecy and authentication of future messages can be recovered as long as the
attacker doesn't otherwise get access to the key. Because the adversary doesn't
have the signing key, they cannot authenticate messages on behalf of the
compromised party, even if they still have control over some group keys by
colluding with other members of the group.<a href="#section-8.3.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3.3-4">This is in contrast with the case where the signature key is leaked. In that
case the compromised endpoint needs to refresh its credentials and invalidate
the old credentials before the attacker will be unable to authenticate messages.<a href="#section-8.3.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3.3-5">Beware that in both oracle and private key access, an active adaptive attacker
can follow the protocol and request to update its own credential. This in turn
induces a signature key rotation which could provide the attacker with part or
the full value of the private key depending on the architecture of the service
provider.<a href="#section-8.3.3-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.3.3-6.1">
              <p id="section-8.3.3-6.1.1"><strong>RECOMMENDATION:</strong> Signature private keys should be compartmentalized from
other secrets and preferably protected by an HSM or dedicated hardware
features to allow recovery of the authentication for future messages after a
compromise.<a href="#section-8.3.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.3.3-7.1">
              <p id="section-8.3.3-7.1.1"><strong>RECOMMENDATION:</strong> When the credential type supports revocation, the users of
a group should check for revoked keys.<a href="#section-8.3.3-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="security-consideration-in-the-context-of-a-full-state-compromise">
<section id="section-8.3.4">
          <h4 id="name-security-consideration-in-t">
<a href="#section-8.3.4" class="section-number selfRef">8.3.4. </a><a href="#name-security-consideration-in-t" class="section-name selfRef">Security consideration in the context of a full state compromise</a>
          </h4>
<p id="section-8.3.4-1">In real-world compromise scenarios, it is often the case that adversaries target
specific devices to obtain parts of the memory or even the ability to execute
arbitrary code in the targeted device.<a href="#section-8.3.4-1" class="pilcrow">¶</a></p>
<p id="section-8.3.4-2">Also, recall that in this setting, the application will often retain the
unencrypted messages. If so, the adversary does not have to break encryption at
all to access sent and received messages. Messages may also be sent by using the
application to instruct the protocol implementation.<a href="#section-8.3.4-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.3.4-3.1">
              <p id="section-8.3.4-3.1.1"><strong>RECOMMENDATION:</strong> If messages are stored on the device, they should be
protected using encryption at rest, and the keys used should be stored
securely using dedicated mechanisms on the device.<a href="#section-8.3.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.3.4-4.1">
              <p id="section-8.3.4-4.1.1"><strong>RECOMMENDATION:</strong> If the threat model of the system is against an adversary
which can access the messages on the device without even needing to attack
MLS, the application should delete plaintext and ciphertext messages as soon
as practical after encryption or decryption.<a href="#section-8.3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.3.4-5">Note that this document makes a clear distinction between the way signature keys
and other group shared secrets must be handled.  In particular, a large set of
group secrets cannot necessarily be assumed to be protected by an HSM or secure
enclave features. This is especially true because these keys are frequently used
and changed with each message received by a client.<a href="#section-8.3.4-5" class="pilcrow">¶</a></p>
<p id="section-8.3.4-6">However, the signature private keys are mostly used by clients to send a
message. They also provide strong authentication guarantees to other clients,
hence we consider that their protection by additional security mechanisms should
be a priority.<a href="#section-8.3.4-6" class="pilcrow">¶</a></p>
<p id="section-8.3.4-7">Overall there is no way to detect or prevent these compromises, as discussed in
the previous sections, performing separation of the application secret states
can help recovery after compromise, this is the case for signature keys but
similar concern exists for client's encryption private keys.<a href="#section-8.3.4-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.3.4-8.1">
              <p id="section-8.3.4-8.1.1"><strong>RECOMMENDATION:</strong> The secret keys used for public key encryption should be
stored similarly to the way the signature keys are stored, as keys can be used
to decrypt the group operation messages and contain the secret material used
to compute all the group secrets.<a href="#section-8.3.4-8.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.3.4-9">Even if secure enclaves are not perfectly secure, or even completely broken,
adopting additional protections for these keys can ease recovery of the secrecy
and authentication guarantees after a compromise where, for instance, an
attacker can sign messages without having access to the key. In certain
contexts, the rotation of credentials might only be triggered by the AS through
ACLs, hence be outside of the capabilities of the attacker.<a href="#section-8.3.4-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="service-node-compromise">
<section id="section-8.4">
        <h3 id="name-service-node-compromise">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-service-node-compromise" class="section-name selfRef">Service Node Compromise</a>
        </h3>
<div id="general-considerations">
<section id="section-8.4.1">
          <h4 id="name-general-considerations">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-general-considerations" class="section-name selfRef">General considerations</a>
          </h4>
<div id="privacy-of-the-network-connections">
<section id="section-8.4.1.1">
            <h5 id="name-privacy-of-the-network-conn">
<a href="#section-8.4.1.1" class="section-number selfRef">8.4.1.1. </a><a href="#name-privacy-of-the-network-conn" class="section-name selfRef">Privacy of the network connections</a>
            </h5>
<p id="section-8.4.1.1-1">There are many scenarios leading to communication between the application on a
device and the Delivery Service or the Authentication Service. In particular
when:<a href="#section-8.4.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.1.1-2.1">
                <p id="section-8.4.1.1-2.1.1">The application connects to the Authentication Service to generate or validate
a new credential before distributing it.<a href="#section-8.4.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.4.1.1-2.2">
                <p id="section-8.4.1.1-2.2.1">The application fetches credentials at the Delivery Service prior to creating
a messaging group (one-to-one or more than two clients).<a href="#section-8.4.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.4.1.1-2.3">
                <p id="section-8.4.1.1-2.3.1">The application fetches service provider information or messages on the
Delivery Service.<a href="#section-8.4.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.4.1.1-2.4">
                <p id="section-8.4.1.1-2.4.1">The application sends service provider information or messages to the Delivery
Service.<a href="#section-8.4.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.1.1-3">In all these cases, the application will often connect to the device via a
secure transport which leaks information about the origin of the request such as
the IP address and depending on the protocol the MAC address of the device.<a href="#section-8.4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-8.4.1.1-4">Similar concerns exist in the peer-to-peer use cases of MLS.<a href="#section-8.4.1.1-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.1.1-5.1">
                <p id="section-8.4.1.1-5.1.1"><strong>RECOMMENDATION:</strong> In the case where privacy or anonymity is
important, using adequate protection such as MASQUE
<span>[<a href="#I-D.schinazi-masque-proxy" class="cite xref">I-D.schinazi-masque-proxy</a>]</span>, ToR, or a VPN can improve metadata
protection.<a href="#section-8.4.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.1.1-6">More generally, using anonymous credentials in an MLS based architecture might
not be enough to provide strong privacy or anonymity properties.<a href="#section-8.4.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="storage-of-metadata-and-ecryption-at-rest-on-the-servers">
<section id="section-8.4.1.2">
            <h5 id="name-storage-of-metadata-and-ecr">
<a href="#section-8.4.1.2" class="section-number selfRef">8.4.1.2. </a><a href="#name-storage-of-metadata-and-ecr" class="section-name selfRef">Storage of Metadata and Ecryption at rest on the Servers</a>
            </h5>
<p id="section-8.4.1.2-1">In the case where private data or metadata has to be persisted on the servers
for functionality (mappings between identities and push tokens, group
metadata...), it should be stored encrypted at rest and only decrypted upon need
during the execution. Honest Service Providers can rely on such encryption at
rest mechanism to be able to prevent access to the data when not using it.<a href="#section-8.4.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.1.2-2.1">
                <p id="section-8.4.1.2-2.1.1"><strong>RECOMMENDATION:</strong> Store cryptographic material used for server-side
decryption of sensitive meta-data on the clients and only send it when needed.
The server can use the secret to open and update encrypted data containers
after which they can delete these keys until the next time they need it, in
which case those can be provided by the client.<a href="#section-8.4.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.1.2-3.1">
                <p id="section-8.4.1.2-3.1.1"><strong>RECOMMENDATION:</strong> Rely on group secrets exported from the MLS session for
server-side encryption at rest and update the key after each removal from the
group. Rotate those keys on a regular basis otherwise.<a href="#section-8.4.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="delivery-service-compromise">
<section id="section-8.4.2">
          <h4 id="name-delivery-service-compromise">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-delivery-service-compromise" class="section-name selfRef">Delivery Service Compromise</a>
          </h4>
<p id="section-8.4.2-1">MLS is intended to provide strong guarantees in the face of compromise of the
DS. Even a totally compromised DS should not be able to read messages or inject
messages that will be acceptable to legitimate clients. It should also not be
able to undetectably remove, reorder or replay messages.<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<p id="section-8.4.2-2">However, a malicious DS can mount a variety of DoS attacks on the system,
including total DoS attacks (where it simply refuses to forward any messages)
and partial DoS attacks (where it refuses to forward messages to and from
specific clients).  As noted in <a href="#delivery-guarantees" class="auto internal xref">Section 5.2</a>, these attacks are only
partially detectable by clients without an out-of-band channel. Ultimately,
failure of the DS to provide reasonable service must be dealt with as a customer
service matter, not via technology.<a href="#section-8.4.2-2" class="pilcrow">¶</a></p>
<p id="section-8.4.2-3">Because the DS is responsible for providing the initial keying material to
clients, it can provide stale keys. This does not inherently lead to compromise
of the message stream, but does allow it to attack forward security to a limited
extent. This threat can be mitigated by having initial keys expire.<a href="#section-8.4.2-3" class="pilcrow">¶</a></p>
<p id="section-8.4.2-4">Initial keying material (KeyPackages) using the <code>basic</code> Credential type is more
vulnerable to replacement by a malicious or compromised DS, as there is no
built-in cryptographic binding between the identity and the public key of the
client.<a href="#section-8.4.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.2-5.1">
              <p id="section-8.4.2-5.1.1"><strong>RECOMMENDATION:</strong> Prefer a Credential type in KeyPackages which includes a
strong cryptographic binding between the identity and its key (for example the
<code>x509</code> Credential type). When using the <code>basic</code> Credential type take extra
care to verify the identity (typically out-of-band).<a href="#section-8.4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="privacy-of-delivery-and-push-notifications">
<section id="section-8.4.2.1">
            <h5 id="name-privacy-of-delivery-and-pus">
<a href="#section-8.4.2.1" class="section-number selfRef">8.4.2.1. </a><a href="#name-privacy-of-delivery-and-pus" class="section-name selfRef">Privacy of delivery and push notifications</a>
            </h5>
<p id="section-8.4.2.1-1">An important mechanism that is often ignored from the privacy considerations are
the push-tokens. In many modern messaging architectures, applications are using
push notification mechanisms typically provided by OS vendors. This is to make
sure that when messages are available at the Delivery Service (or by other
mechanisms if the DS is not a central server), the recipient application on a
device knows about it. Sometimes the push notification can contain the
application message itself which saves a round trip with the DS.<a href="#section-8.4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.4.2.1-2">To "push" this information to the device, the service provider and the OS
infrastructures use unique per-device, per-application identifiers called
push-tokens. This means that the push notification provider and the service
provider have information on which devices receive information and at which
point in time. Alternatively, non-mobile applications could use a websocket or
persistent connection for notifications directly from the DS.<a href="#section-8.4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-8.4.2.1-3">Even though they can't necessarily access the content, which is typically
encrypted MLS messages, the service provider and the push notification provider
have to be trusted to avoid making correlation on which devices are recipients
of the same message.<a href="#section-8.4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-8.4.2.1-4">For secure messaging systems, push notifications are often sent real-time as it
is not acceptable to create artificial delays for message retrieval.<a href="#section-8.4.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.2.1-5.1">
                <p id="section-8.4.2.1-5.1.1"><strong>RECOMMENDATION:</strong> If real time notifications are not necessary, one can
delay notifications randomly across recipient devices using a mixnet or other
techniques.<a href="#section-8.4.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.2.1-6">Note that with a legal request to ask the service provider for the push-token
associated with an identifier, it is easy to correlate the token with a second
request to the company operating the push-notification system to get information
about the device, which is often linked with a real identity via a cloud
account, a credit card or other information.<a href="#section-8.4.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.2.1-7.1">
                <p id="section-8.4.2.1-7.1.1"><strong>RECOMMENDATION:</strong> If stronger privacy guarantees are needed with regard to
the push notification provider, the client can choose to periodically connect
to the Delivery Service without the need of a dedicated push notification
infrastructure.<a href="#section-8.4.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.2.1-8">Applications can also consider anonymous systems for server fanout (for
example <span>[<a href="#Loopix" class="cite xref">Loopix</a>]</span>).<a href="#section-8.4.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="as-compromise">
<section id="section-8.4.3">
          <h4 id="name-authentication-service-comp">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-authentication-service-comp" class="section-name selfRef">Authentication Service Compromise</a>
          </h4>
<p id="section-8.4.3-1">The Authentication Service design is left to the infrastructure designers. In
most designs, a compromised AS is a serious matter, as the AS can serve
incorrect or attacker-provided identities to clients.<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.3-2.1">
              <p id="section-8.4.3-2.1.1">The attacker can link an identity to a credential<a href="#section-8.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.4.3-2.2">
              <p id="section-8.4.3-2.2.1">The attacker can generate new credentials<a href="#section-8.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.4.3-2.3">
              <p id="section-8.4.3-2.3.1">The attacker can sign new credentials<a href="#section-8.4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.4.3-2.4">
              <p id="section-8.4.3-2.4.1">The attacker can publish or distribute credentials<a href="#section-8.4.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.4.3-3">An attacker that can generate or sign new credentials may or may not have access
to the underlying cryptographic material necessary to perform such
operations. In that last case, it results in windows of time for which all
emitted credentials might be compromised.<a href="#section-8.4.3-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3-4.1">
              <p id="section-8.4.3-4.1.1"><strong>RECOMMENDATION:</strong> Use HSMs to store the root signature keys to limit the
ability of an adversary with no physical access to extract the top-level
signature private key.<a href="#section-8.4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.4.3-5">Note that historically some systems generate signature keys on the
Authentication Service and distribute the private keys to clients along with
their credential. This is a dangerous practice because it allows the AS or an
attacker who has compromised the AS to silently impersonate the client.<a href="#section-8.4.3-5" class="pilcrow">¶</a></p>
<div id="authentication-compromise-ghost-users-and-impersonations">
<section id="section-8.4.3.1">
            <h5 id="name-authentication-compromise-g">
<a href="#section-8.4.3.1" class="section-number selfRef">8.4.3.1. </a><a href="#name-authentication-compromise-g" class="section-name selfRef">Authentication compromise: Ghost users and impersonations</a>
            </h5>
<p id="section-8.4.3.1-1">One important property of MLS is that all Members know which other members are
in the group at all times. If all Members of the group and the Authentication
Service are honest, no parties other than the members of the current group can
read and write messages protected by the protocol for that Group.<a href="#section-8.4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.4.3.1-2">This guarantee applies to the the cryptographic identities of the members.
Details about how to verify the identity of a client depend on the MLS
Credential type used. For example, cryptographic verification of credentials can
be largely performed autonomously (e.g., without user interaction) by the
clients themselves for the <code>x509</code> Credential type.<a href="#section-8.4.3.1-2" class="pilcrow">¶</a></p>
<p id="section-8.4.3.1-3">In contrast, when MLS clients use the <code>basic</code> Credential type, then some other
mechanism must be used to verify identities. For instance the Authentication
Service could operate some sort of directory server to provide keys, or users
could verify keys via an out-of-band mechanism.<a href="#section-8.4.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3.1-4.1">
                <p id="section-8.4.3.1-4.1.1"><strong>RECOMMENDATION:</strong> Select the MLS Credential type with the strongest security
which is supported by all target members of an MLS group.<a href="#section-8.4.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3.1-5.1">
                <p id="section-8.4.3.1-5.1.1"><strong>RECOMMENDATION:</strong> Do not use the same signature keypair across
groups. Update all keys for all groups on a regular basis. Do not preserve
keys in different groups when suspecting a compromise.<a href="#section-8.4.3.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.3.1-6">If the AS is compromised, it could validate a (or generate a new) signature
keypair for an attacker. The attacker could then use this keypair to join a
group as if it were another of the user's clients.  Because a user can have many
MLS clients running the MLS protocol, it possibly has many signature keypairs
for multiple devices. These attacks could be very difficult to detect,
especially in large groups where the UI might not reflect all the changes back
to the users. If the application participates in a key transparency mechanism in
which it is possible to determine every key for a given user, then this then
this would allow for the detection of surreptitiously created false credentials.<a href="#section-8.4.3.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3.1-7.1">
                <p id="section-8.4.3.1-7.1.1"><strong>RECOMMENDATION:</strong> Make sure that MLS clients reflect all the membership
changes to the users as they happen. If a choice has to be made because the
number of notifications is too high, the client should provide a log of state
of the device so that the user can examine it.<a href="#section-8.4.3.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3.1-8.1">
                <p id="section-8.4.3.1-8.1.1"><strong>RECOMMENDATION:</strong> Provide a key transparency mechanism for the
Authentication Services to allow public verification of the credentials
authenticated by this service.<a href="#section-8.4.3.1-8.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.3.1-9">While the ways to handle MLS credentials are not defined by the protocol or the
architecture documents, the MLS protocol has been designed with a mechanism that
can be used to provide out-of-band authentication to users. The
"authentication_secret" generated for each user at each epoch of the group is a
one-time, per client, authentication secret which can be exchanged between users
to prove their identity to each other. This can be done for instance using a QR
code that can be scanned by the other parties.<a href="#section-8.4.3.1-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3.1-10.1">
                <p id="section-8.4.3.1-10.1.1"><strong>RECOMMENDATION:</strong> Provide one or more out-of-band authentication mechanisms
to limit the impact of an Authentication Service compromise.<a href="#section-8.4.3.1-10.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.3.1-11">We note, again, that as described prior to that section, the Authentication
Service may not be a centralized system, and could be realized by many
mechanisms such as establishing prior one-to-one deniable channels, gossiping,
or using trust on first use (TOFU) for credentials used by the MLS Protocol.<a href="#section-8.4.3.1-11" class="pilcrow">¶</a></p>
<p id="section-8.4.3.1-12">Another important consideration is the ease of redistributing new keys on client
compromise, which helps recovering security faster in various cases.<a href="#section-8.4.3.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-of-the-group-membership">
<section id="section-8.4.3.2">
            <h5 id="name-privacy-of-the-group-member">
<a href="#section-8.4.3.2" class="section-number selfRef">8.4.3.2. </a><a href="#name-privacy-of-the-group-member" class="section-name selfRef">Privacy of the Group Membership</a>
            </h5>
<p id="section-8.4.3.2-1">Group membership is itself sensitive information and MLS is designed to limit
the amount of persistent metadata. However, large groups often require an
infrastructure which provides server fanout.  In the case of client fanout, the
destination of a message is known by all clients, hence the server usually does
not need this information.  However, they may learn this information through
traffic analysis.  Unfortunately, in a server-side fanout model, the Delivery
Service can learn that a given client is sending the same message to a set of
other clients. In addition, there may be applications of MLS in which the group
membership list is stored on some server associated with the Delivery Service.<a href="#section-8.4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-8.4.3.2-2">While this knowledge is not a breach of the protocol's authentication or
confidentiality guarantees, it is a serious issue for privacy.<a href="#section-8.4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-8.4.3.2-3">Some infrastructure keep a mapping between keys used in the MLS protocol and
user identities. An attacker with access to this information due to compromise
or regulation can associate unencrypted group messages (e.g., Commits and
Proposals) with the corresponding user identity.<a href="#section-8.4.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3.2-4.1">
                <p id="section-8.4.3.2-4.1.1"><strong>RECOMMENDATION:</strong> Use encrypted group operation messages to limit privacy
risks whenever possible.<a href="#section-8.4.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-8.4.3.2-5">In certain cases, the adversary can access specific bindings between public keys
and identities. If the signature keys are reused across groups, the adversary
can get more information about the targeted user.<a href="#section-8.4.3.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.4.3.2-6.1">
                <p id="section-8.4.3.2-6.1.1"><strong>RECOMMENDATION:</strong> Ensure that the linking between public keys and identities
only happen in expected scenarios. Otherwise privilege a stronger separation.<a href="#section-8.4.3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="considerations-for-attacks-outside-of-the-threat-model">
<section id="section-8.5">
        <h3 id="name-considerations-for-attacks-">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-considerations-for-attacks-" class="section-name selfRef">Considerations for attacks outside of the threat model</a>
        </h3>
<p id="section-8.5-1">Physical attacks on devices storing and executing MLS principals are not
considered in depth in the threat model of the MLS protocol.  While
non-permanent, non-invasive attacks can sometimes be equivalent to software
attacks, physical attacks are considered outside of the MLS threat model.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">Compromise scenarios typically consist of a software adversary, which can
maintain active adaptive compromise and arbitrarily change the behavior of the
client or service.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5-3">On the other hand, security goals consider that honest clients will always run
the protocol according to its specification. This relies on implementations of
the protocol to securely implement the specification, which remains non-trivial.<a href="#section-8.5-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.5-4.1">
            <p id="section-8.5-4.1.1"><strong>RECOMMENDATION:</strong> Additional steps should be taken to protect the device and
the MLS clients from physical compromise. In such settings, HSMs and secure
enclaves can be used to protect signature keys.<a href="#section-8.5-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="cryptographic-analysis-of-the-mls-protocol">
<section id="section-8.6">
        <h3 id="name-cryptographic-analysis-of-t">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-cryptographic-analysis-of-t" class="section-name selfRef">Cryptographic Analysis of the MLS Protocol</a>
        </h3>
<p id="section-8.6-1">Various academic works have analyzed MLS and the different security guarantees
it aims to provide. The security of large parts of the protocol has been
analyzed by <span>[<a href="#BBN19" class="cite xref">BBN19</a>]</span> (draft 7), <span>[<a href="#ACDT21" class="cite xref">ACDT21</a>]</span> (draft 11) and <span>[<a href="#AJM20" class="cite xref">AJM20</a>]</span> (draft 12).<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">Individual components of various drafts of the MLS protocol have been analyzed
in isolation and with differing adversarial models, for example, <span>[<a href="#BBR18" class="cite xref">BBR18</a>]</span>,
<span>[<a href="#ACDT19" class="cite xref">ACDT19</a>]</span>, <span>[<a href="#ACCKKMPPWY19" class="cite xref">ACCKKMPPWY19</a>]</span>, <span>[<a href="#AJM20" class="cite xref">AJM20</a>]</span>, <span>[<a href="#ACJM20" class="cite xref">ACJM20</a>]</span>, and <span>[<a href="#AHKM21" class="cite xref">AHKM21</a>]</span> analyze the
ratcheting tree sub-protocol of MLS that facilitates key agreement, <span>[<a href="#WPBB22" class="cite xref">WPBB22</a>]</span>
analyzes the sub-protocol of MLS for group state agreement and authentication,
while <span>[<a href="#BCK21" class="cite xref">BCK21</a>]</span> analyzes the key derivation paths in the ratchet tree and key
schedule. Finally, <span>[<a href="#CHK21" class="cite xref">CHK21</a>]</span> analyzes the authentication and cross-group healing
guarantees provided by MLS.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document makes no requests of IANA.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-mls-protocol">[I-D.ietf-mls-protocol]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-protocol-20</span>, <time datetime="2023-03-27" class="refDate">27 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-protocol-20">https://datatracker.ietf.org/doc/html/draft-ietf-mls-protocol-20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5116">https://www.rfc-editor.org/rfc/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9420">[RFC9420]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="seriesInfo">RFC 9420</span>, <span class="seriesInfo">DOI 10.17487/RFC9420</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9420">https://www.rfc-editor.org/rfc/rfc9420</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ACCKKMPPWY19">[ACCKKMPPWY19]</dt>
        <dd>
<span class="refAuthor">Alwen, J.</span>, <span class="refAuthor">Capretto, M.</span>, <span class="refAuthor">Cueto, M.</span>, <span class="refAuthor">Kamath, C.</span>, <span class="refAuthor">Klein, K.</span>, <span class="refAuthor">Markov, I.</span>, <span class="refAuthor">Pascual-Perez, G.</span>, <span class="refAuthor">Pietrzak, K.</span>, <span class="refAuthor">Walter, M.</span>, and <span class="refAuthor">M. Yeo</span>, <span class="refTitle">"Security Analysis and Improvements for the IETF MLS Standard for Group Messaging"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://eprint.iacr.org/2019/1489">https://eprint.iacr.org/2019/1489</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ACDT19">[ACDT19]</dt>
        <dd>
<span class="refAuthor">Alwen, J.</span>, <span class="refAuthor">Coretti, S.</span>, <span class="refAuthor">Dodis, Y.</span>, and <span class="refAuthor">Y. Tselekounis</span>, <span class="refTitle">"Security Analysis and Improvements for the IETF MLS Standard for Group Messaging"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://eprint.iacr.org/2019/1189.pdf">https://eprint.iacr.org/2019/1189.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ACDT21">[ACDT21]</dt>
        <dd>
<span class="refAuthor">Alwen, J.</span>, <span class="refAuthor">Coretti, S.</span>, <span class="refAuthor">Dodis, Y.</span>, and <span class="refAuthor">Y. Tselekounis</span>, <span class="refTitle">"Modular Design of Secure Group Messaging Protocols and the Security of MLS"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://eprint.iacr.org/2021/1083.pdf">https://eprint.iacr.org/2021/1083.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ACJM20">[ACJM20]</dt>
        <dd>
<span class="refAuthor">Alwen, J.</span>, <span class="refAuthor">Coretti, S.</span>, <span class="refAuthor">Jost, D.</span>, and <span class="refAuthor">M. Mularczyk</span>, <span class="refTitle">"Continuous Group Key Agreement with Active Security"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/752.pdf">https://eprint.iacr.org/2020/752.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AHKM21">[AHKM21]</dt>
        <dd>
<span class="refAuthor">Alwen, J.</span>, <span class="refAuthor">Hartmann, D.</span>, <span class="refAuthor">Kiltz, E.</span>, and <span class="refAuthor">M. Mularczyk</span>, <span class="refTitle">"Server-Aided Continuous Group Key Agreement"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://eprint.iacr.org/2021/1456.pdf">https://eprint.iacr.org/2021/1456.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AJM20">[AJM20]</dt>
        <dd>
<span class="refAuthor">Alwen, J.</span>, <span class="refAuthor">Jost, D.</span>, and <span class="refAuthor">M. Mularczyk</span>, <span class="refTitle">"On The Insider Security of MLS"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/1327.pdf">https://eprint.iacr.org/2020/1327.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBN19">[BBN19]</dt>
        <dd>
<span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Beurdouche, B.</span>, and <span class="refAuthor">P. Naldurg</span>, <span class="refTitle">"Formal Models and Verified Protocols for Group Messaging: Attacks and Proofs for IETF MLS"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://hal.laas.fr/INRIA/hal-02425229v1/file/mls-treekem.pdf">https://hal.laas.fr/INRIA/hal-02425229v1/file/mls-treekem.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBR18">[BBR18]</dt>
        <dd>
<span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Barnes, R.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"TreeKEM: Asynchronous Decentralized Key Management for Large Dynamic Groups A protocol proposal for Messaging Layer Security (MLS)"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://hal.inria.fr/hal-02425247/file/treekem+%281%29.pdf">https://hal.inria.fr/hal-02425247/file/treekem+%281%29.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BCK21">[BCK21]</dt>
        <dd>
<span class="refAuthor">Brzuska, C.</span>, <span class="refAuthor">Cornelissen, E.</span>, and <span class="refAuthor">K. Kohbrok</span>, <span class="refTitle">"Cryptographic Security of the MLS RFC, Draft 11"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://eprint.iacr.org/2021/137.pdf">https://eprint.iacr.org/2021/137.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CAPBR">[CAPBR]</dt>
        <dd>
<span class="refAuthor">Brewer, E.</span>, <span class="refTitle">"Towards robust distributed systems (abstract)"</span>, <span class="refContent">ACM</span>, <span class="seriesInfo">Proceedings of the nineteenth annual ACM symposium on Principles of distributed computing</span>, <span class="seriesInfo">DOI 10.1145/343477.343502</span>, <time datetime="2000-07" class="refDate">July 2000</time>, <span>&lt;<a href="https://doi.org/10.1145/343477.343502">https://doi.org/10.1145/343477.343502</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHK21">[CHK21]</dt>
        <dd>
<span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Hale, B.</span>, and <span class="refAuthor">K. Kohbrok</span>, <span class="refTitle">"The Complexities of Healing in Secure Group Messaging: Why Cross-Group Effects Matter"</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.usenix.org/system/files/sec21-cremers.pdf">https://www.usenix.org/system/files/sec21-cremers.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CONIKS">[CONIKS]</dt>
        <dd>
<span class="refAuthor">Melara, M.</span>, <span class="refAuthor">Blankstein, A.</span>, <span class="refAuthor">Bonneau, J.</span>, <span class="refAuthor">Felten, E.</span>, and <span class="refAuthor">M. Freedman</span>, <span class="refTitle">"CONIKS: Bringing Key Transparency to End Users"</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="https://www.usenix.org/system/files/conference/usenixsecurity15/sec15-paper-melara.pdf">https://www.usenix.org/system/files/conference/usenixsecurity15/sec15-paper-melara.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-mls-extensions">[I-D.ietf-mls-extensions]</dt>
        <dd>
<span class="refAuthor">Robert, R.</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Extensions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-extensions-03</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-extensions-03">https://datatracker.ietf.org/doc/html/draft-ietf-mls-extensions-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-mls-federation">[I-D.ietf-mls-federation]</dt>
        <dd>
<span class="refAuthor">Omara, E.</span> and <span class="refAuthor">R. Robert</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Federation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-federation-03</span>, <time datetime="2023-09-09" class="refDate">9 September 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-federation-03">https://datatracker.ietf.org/doc/html/draft-ietf-mls-federation-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.schinazi-masque-proxy">[I-D.schinazi-masque-proxy]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span>, <span class="refTitle">"The MASQUE Proxy"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-schinazi-masque-proxy-02</span>, <time datetime="2024-02-28" class="refDate">28 February 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-schinazi-masque-proxy-02">https://datatracker.ietf.org/doc/html/draft-schinazi-masque-proxy-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KT">[KT]</dt>
        <dd>
<span class="refAuthor">McMillion, B.</span>, <span class="refTitle">"Key Transparency Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-keytrans-architecture-01</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-keytrans-architecture-01">https://datatracker.ietf.org/doc/html/draft-ietf-keytrans-architecture-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Loopix">[Loopix]</dt>
        <dd>
<span class="refAuthor">Piotrowska, A. M.</span>, <span class="refAuthor">Hayes, J.</span>, <span class="refAuthor">Elahi, T.</span>, <span class="refAuthor">Meiser, S.</span>, and <span class="refAuthor">G. Danezis</span>, <span class="refTitle">"The Loopix Anonymity System"</span>, <time datetime="2017" class="refDate">2017</time>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3552">https://www.rfc-editor.org/rfc/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6120">[RFC6120]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span>, <span class="refTitle">"Extensible Messaging and Presence Protocol (XMPP): Core"</span>, <span class="seriesInfo">RFC 6120</span>, <span class="seriesInfo">DOI 10.17487/RFC6120</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6120">https://www.rfc-editor.org/rfc/rfc6120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WPBB22">[WPBB22]</dt>
      <dd>
<span class="refAuthor">Wallez, T.</span>, <span class="refAuthor">Protzenko, J.</span>, <span class="refAuthor">Beurdouche, B.</span>, and <span class="refAuthor">K. Bhargavan</span>, <span class="refTitle">"TreeSync: Authenticated Group Management for Messaging Layer Security"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://eprint.iacr.org/2022/1732.pdf">https://eprint.iacr.org/2022/1732.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="contributors">
<section id="appendix-A">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Richard Barnes</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rlb@ipv.sx" class="email">rlb@ipv.sx</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Katriel Cohn-Gordon</span></div>
<div dir="auto" class="left"><span class="org">Meta Platforms</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:me@katriel.co.uk" class="email">me@katriel.co.uk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Cas Cremers</span></div>
<div dir="auto" class="left"><span class="org">CISPA Helmholtz Center for Information Security</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cremers@cispa.de" class="email">cremers@cispa.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Britta Hale</span></div>
<div dir="auto" class="left"><span class="org">Naval Postgraduate School</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:britta.hale@nps.edu" class="email">britta.hale@nps.edu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Albert Kwon</span></div>
<div dir="auto" class="left"><span class="org">Badge Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kwonalbert@badgeinc.com" class="email">kwonalbert@badgeinc.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Konrad Kohbrok</span></div>
<div dir="auto" class="left"><span class="org">Phoenix R&amp;D</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:konrad.kohbrok@datashrine.de" class="email">konrad.kohbrok@datashrine.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rohan Mahy</span></div>
<div dir="auto" class="left"><span class="org">Wire</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rohan.mahy@wire.com" class="email">rohan.mahy@wire.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brendan McMillion</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:brendanmcmillion@gmail.com" class="email">brendanmcmillion@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thyla van der Merwe</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tjvdmerwe@gmail.com" class="email">tjvdmerwe@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jon Millican</span></div>
<div dir="auto" class="left"><span class="org">Meta Platforms</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jmillican@meta.com" class="email">jmillican@meta.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Raphael Robert</span></div>
<div dir="auto" class="left"><span class="org">Phoenix R&amp;D</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@raphaelrobert.com" class="email">ietf@raphaelrobert.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Benjamin Beurdouche</span></div>
<div dir="auto" class="left"><span class="org">Inria &amp; Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@beurdouche.com" class="email">ietf@beurdouche.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Rescorla</span></div>
<div dir="auto" class="left"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ekr@rtfm.com" class="email">ekr@rtfm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Emad Omara</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:emad.omara@gmail.com" class="email">emad.omara@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Srinivas Inguva</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:singuva@yahoo.com" class="email">singuva@yahoo.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alan Duric</span></div>
<div dir="auto" class="left"><span class="org">Wire</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alan@wire.com" class="email">alan@wire.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
